%% Generated by Sphinx.
\def\sphinxdocclass{report}
\documentclass[letterpaper,10pt,english]{sphinxmanual}
\ifdefined\pdfpxdimen
   \let\sphinxpxdimen\pdfpxdimen\else\newdimen\sphinxpxdimen
\fi \sphinxpxdimen=.75bp\relax
\ifdefined\pdfimageresolution
    \pdfimageresolution= \numexpr \dimexpr1in\relax/\sphinxpxdimen\relax
\fi
%% let collapsable pdf bookmarks panel have high depth per default
\PassOptionsToPackage{bookmarksdepth=5}{hyperref}

\PassOptionsToPackage{warn}{textcomp}
\usepackage[utf8]{inputenc}
\ifdefined\DeclareUnicodeCharacter
% support both utf8 and utf8x syntaxes
  \ifdefined\DeclareUnicodeCharacterAsOptional
    \def\sphinxDUC#1{\DeclareUnicodeCharacter{"#1}}
  \else
    \let\sphinxDUC\DeclareUnicodeCharacter
  \fi
  \sphinxDUC{00A0}{\nobreakspace}
  \sphinxDUC{2500}{\sphinxunichar{2500}}
  \sphinxDUC{2502}{\sphinxunichar{2502}}
  \sphinxDUC{2514}{\sphinxunichar{2514}}
  \sphinxDUC{251C}{\sphinxunichar{251C}}
  \sphinxDUC{2572}{\textbackslash}
\fi
\usepackage{cmap}
\usepackage[T1]{fontenc}
\usepackage{amsmath,amssymb,amstext}
\usepackage{babel}



\usepackage{tgtermes}
\usepackage{tgheros}
\renewcommand{\ttdefault}{txtt}



\usepackage[Bjarne]{fncychap}
\usepackage{sphinx}

\fvset{fontsize=auto}
\usepackage{geometry}


% Include hyperref last.
\usepackage{hyperref}
% Fix anchor placement for figures with captions.
\usepackage{hypcap}% it must be loaded after hyperref.
% Set up styles of URL: it should be placed after hyperref.
\urlstyle{same}

\addto\captionsenglish{\renewcommand{\contentsname}{Usage}}

\usepackage{sphinxmessages}
\setcounter{tocdepth}{1}



\title{dtwhaclustering}
\date{Aug 22, 2021}
\release{1.0}
\author{Utpal Kumar}
\newcommand{\sphinxlogo}{\vbox{}}
\renewcommand{\releasename}{Release}
\makeindex
\begin{document}

\pagestyle{empty}
\sphinxmaketitle
\pagestyle{plain}
\sphinxtableofcontents
\pagestyle{normal}
\phantomsection\label{\detokenize{index::doc}}

\phantomsection\label{\detokenize{usage/module_contents:module-dtwhaclustering}}\index{module@\spxentry{module}!dtwhaclustering@\spxentry{dtwhaclustering}}\index{dtwhaclustering@\spxentry{dtwhaclustering}!module@\spxentry{module}}

\chapter{Dynamic Time Warping based Hierarchical Agglomerative Clustering}
\label{\detokenize{usage/module_contents:dynamic-time-warping-based-hierarchical-agglomerative-clustering}}\label{\detokenize{usage/module_contents::doc}}
\sphinxAtStartPar
Codes to perform Dynamic Time Warping Based Hierarchical Agglomerative Clustering of GPS data
\begin{quote}\begin{description}
\item[{author}] \leavevmode
\sphinxAtStartPar
Utpal Kumar

\item[{date}] \leavevmode
\sphinxAtStartPar
2021/08

\item[{copyright}] \leavevmode
\sphinxAtStartPar
2021, Institute of Earth Sciences, Academia Sinica.

\end{description}\end{quote}


\chapter{Installation}
\label{\detokenize{usage/install:installation}}\label{\detokenize{usage/install::doc}}

\section{Requirements}
\label{\detokenize{usage/install:requirements}}\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{dtaidistance}}: For computing DTW distance

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{pygmt}}: For plotting high\sphinxhyphen{}resolution maps

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{pandas}}: Analyze tabular data

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{numpy}}: Computation

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{matplotlib}}: Plotting time series

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{scipy}}: Interpolating data

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{xarray}}: Multilayered data structure

\end{enumerate}


\section{Install from PyPI}
\label{\detokenize{usage/install:install-from-pypi}}
\sphinxAtStartPar
This package is available on PyPI (requires Python 3):

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{pip} \PYG{n}{install} \PYG{n}{dtwhaclustering}
\end{sphinxVerbatim}


\chapter{Signal Analysis}
\label{\detokenize{usage/signal_analysis_examples:signal-analysis}}\label{\detokenize{usage/signal_analysis_examples::doc}}

\section{Create signals for analysis}
\label{\detokenize{usage/signal_analysis_examples:create-signals-for-analysis}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{seed}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{} sampling parameters}
\PYG{n}{fs} \PYG{o}{=} \PYG{l+m+mi}{100}   \PYG{c+c1}{\PYGZsh{} sampling rate, in Hz}
\PYG{n}{T} \PYG{o}{=} \PYG{l+m+mi}{1}      \PYG{c+c1}{\PYGZsh{} duration, in seconds}
\PYG{n}{N} \PYG{o}{=} \PYG{n}{T} \PYG{o}{*} \PYG{n}{fs}  \PYG{c+c1}{\PYGZsh{} duration, in samples}

\PYG{c+c1}{\PYGZsh{} time variable}
\PYG{n}{t} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{linspace}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{T}\PYG{p}{,} \PYG{n}{N}\PYG{p}{)}

\PYG{n}{SNR} \PYG{o}{=} \PYG{l+m+mf}{0.2} \PYG{c+c1}{\PYGZsh{}noise}

\PYG{n}{XX0} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sin}\PYG{p}{(}\PYG{l+m+mi}{2} \PYG{o}{*} \PYG{n}{np}\PYG{o}{.}\PYG{n}{pi} \PYG{o}{*} \PYG{n}{t} \PYG{o}{*} \PYG{l+m+mi}{7}\PYG{o}{+}\PYG{n}{np}\PYG{o}{.}\PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{)} \PYG{c+c1}{\PYGZsh{}+ np.random.randn(1, N) * SNR}
\PYG{n}{XX1} \PYG{o}{=} \PYG{n}{signal}\PYG{o}{.}\PYG{n}{sawtooth}\PYG{p}{(}\PYG{l+m+mi}{2} \PYG{o}{*} \PYG{n}{np}\PYG{o}{.}\PYG{n}{pi} \PYG{o}{*} \PYG{n}{t} \PYG{o}{*} \PYG{l+m+mi}{5}\PYG{o}{+}\PYG{n}{np}\PYG{o}{.}\PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{)} \PYG{c+c1}{\PYGZsh{}+ np.random.randn(1, N) * SNR}
\PYG{n}{s1}\PYG{p}{,} \PYG{n}{s2} \PYG{o}{=} \PYG{n}{XX0}\PYG{p}{,} \PYG{n}{XX1}
\end{sphinxVerbatim}


\section{Inspect the DTW distance between two signals}
\label{\detokenize{usage/signal_analysis_examples:inspect-the-dtw-distance-between-two-signals}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{dtwsig} \PYG{o}{=} \PYG{n}{dtw\PYGZus{}signal\PYGZus{}pairs}\PYG{p}{(}\PYG{n}{s1}\PYG{p}{,} \PYG{n}{s2}\PYG{p}{,} \PYG{n}{labels}\PYG{o}{=}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{S1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{S2}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{dtwsig}\PYG{o}{.}\PYG{n}{plot\PYGZus{}signals}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{fig_s1_s2}.png}


\section{Plot warping path}
\label{\detokenize{usage/signal_analysis_examples:plot-warping-path}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{matplotlib}\PYG{o}{.}\PYG{n}{rcParams}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{pdf.fonttype}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{l+m+mi}{42}
\PYG{n}{distance}\PYG{p}{,}\PYG{n}{\PYGZus{}}\PYG{p}{,}\PYG{n}{\PYGZus{}} \PYG{o}{=} \PYG{n}{dtwsig}\PYG{o}{.}\PYG{n}{plot\PYGZus{}warping\PYGZus{}path}\PYG{p}{(}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{DTW distance between signals: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{distance}\PYG{l+s+si}{:}\PYG{l+s+s2}{.4f}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

\PYG{n}{plt}\PYG{o}{.}\PYG{n}{savefig}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{warping\PYGZus{}path\PYGZus{}s1\PYGZus{}s2.pdf}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{bbox\PYGZus{}inches}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{tight}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
DTW distance between signals: 5.2093

\noindent\sphinxincludegraphics{{warping_path_s1_s2}.pdf}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{dtwsig}\PYG{o}{.}\PYG{n}{plot\PYGZus{}matrix}\PYG{p}{(}\PYG{n}{windowfrac}\PYG{o}{=}\PYG{l+m+mf}{0.6}\PYG{p}{,} \PYG{n}{psi}\PYG{o}{=}\PYG{k+kc}{None}\PYG{p}{)} \PYG{c+c1}{\PYGZsh{}Only allow for shifts up to 60\PYGZpc{} of the minimum signal length away from the two diagonals.}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{warping_matrix}.png}


\section{Create multiple signals}
\label{\detokenize{usage/signal_analysis_examples:create-multiple-signals}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{fs} \PYG{o}{=} \PYG{l+m+mi}{100}   \PYG{c+c1}{\PYGZsh{} sampling rate, in Hz}
\PYG{n}{T}  \PYG{o}{=} \PYG{l+m+mi}{1}      \PYG{c+c1}{\PYGZsh{} duration, in seconds}

\PYG{n}{N}  \PYG{o}{=} \PYG{n}{T} \PYG{o}{*} \PYG{n}{fs} \PYG{c+c1}{\PYGZsh{} duration, in samples}
\PYG{n}{M}  \PYG{o}{=} \PYG{l+m+mi}{5}      \PYG{c+c1}{\PYGZsh{} number of sources}
\PYG{n}{S1} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sin}\PYG{p}{(}\PYG{l+m+mi}{2} \PYG{o}{*} \PYG{n}{np}\PYG{o}{.}\PYG{n}{pi} \PYG{o}{*} \PYG{n}{t} \PYG{o}{*} \PYG{l+m+mi}{7}\PYG{p}{)}
\PYG{n}{S2} \PYG{o}{=} \PYG{n}{signal}\PYG{o}{.}\PYG{n}{sawtooth}\PYG{p}{(}\PYG{l+m+mi}{2} \PYG{o}{*} \PYG{n}{np}\PYG{o}{.}\PYG{n}{pi} \PYG{o}{*} \PYG{n}{t} \PYG{o}{*} \PYG{l+m+mi}{5}\PYG{p}{)}
\PYG{n}{S3} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{abs}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{cos}\PYG{p}{(}\PYG{l+m+mi}{2} \PYG{o}{*} \PYG{n}{np}\PYG{o}{.}\PYG{n}{pi} \PYG{o}{*} \PYG{n}{t} \PYG{o}{*} \PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)} \PYG{o}{\PYGZhy{}} \PYG{l+m+mf}{0.5}
\PYG{n}{S4} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sign}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{sin}\PYG{p}{(}\PYG{l+m+mi}{2} \PYG{o}{*} \PYG{n}{np}\PYG{o}{.}\PYG{n}{pi} \PYG{o}{*} \PYG{n}{t} \PYG{o}{*} \PYG{l+m+mi}{8}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{S5} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{randn}\PYG{p}{(}\PYG{n}{N}\PYG{p}{)}

\PYG{n}{time\PYGZus{}series} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{n}{S1}\PYG{p}{,} \PYG{n}{S2}\PYG{p}{,} \PYG{n}{S3}\PYG{p}{,} \PYG{n}{S4}\PYG{p}{,} \PYG{n}{S5}\PYG{p}{]}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{}\PYGZsh{} instantiate the class}
\PYG{n}{dtw\PYGZus{}cluster} \PYG{o}{=} \PYG{n}{dtw\PYGZus{}clustering}\PYG{p}{(}\PYG{n}{time\PYGZus{}series}\PYG{p}{,}\PYG{n}{labels}\PYG{o}{=}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{S1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{S2}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{S3}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{S4}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{S5}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}

\PYG{n}{matplotlib}\PYG{o}{.}\PYG{n}{rcParams}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{pdf.fonttype}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{l+m+mi}{42}
\PYG{n}{dtw\PYGZus{}cluster}\PYG{o}{.}\PYG{n}{plot\PYGZus{}signals}\PYG{p}{(}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{} plt.show()}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{savefig}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{base\PYGZus{}functions.pdf}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{bbox\PYGZus{}inches}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{tight}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{base_functions}.pdf}


\section{Compute the relative DTW distance between the signals}
\label{\detokenize{usage/signal_analysis_examples:compute-the-relative-dtw-distance-between-the-signals}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{ds} \PYG{o}{=} \PYG{n}{dtw\PYGZus{}cluster}\PYG{o}{.}\PYG{n}{compute\PYGZus{}distance\PYGZus{}matrix}\PYG{p}{(}\PYG{n}{compact}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{)}
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{p}{[}\PYG{l+m+mf}{0.}        \PYG{p}{,} \PYG{l+m+mf}{5.15998322}\PYG{p}{,} \PYG{l+m+mf}{4.19080907}\PYG{p}{,} \PYG{l+m+mf}{5.77875263}\PYG{p}{,} \PYG{l+m+mf}{7.95685039}\PYG{p}{]}\PYG{p}{,}
\PYG{p}{[}\PYG{l+m+mf}{5.15998322}\PYG{p}{,} \PYG{l+m+mf}{0.}        \PYG{p}{,} \PYG{l+m+mf}{4.74413601}\PYG{p}{,} \PYG{l+m+mf}{7.71110741}\PYG{p}{,} \PYG{l+m+mf}{9.31343712}\PYG{p}{]}\PYG{p}{,}
\PYG{p}{[}\PYG{l+m+mf}{4.19080907}\PYG{p}{,} \PYG{l+m+mf}{4.74413601}\PYG{p}{,} \PYG{l+m+mf}{0.}        \PYG{p}{,} \PYG{l+m+mf}{8.75201301}\PYG{p}{,} \PYG{l+m+mf}{8.51048008}\PYG{p}{]}\PYG{p}{,}
\PYG{p}{[}\PYG{l+m+mf}{5.77875263}\PYG{p}{,} \PYG{l+m+mf}{7.71110741}\PYG{p}{,} \PYG{l+m+mf}{8.75201301}\PYG{p}{,} \PYG{l+m+mf}{0.}        \PYG{p}{,} \PYG{l+m+mf}{9.18406086}\PYG{p}{]}\PYG{p}{,}
\PYG{p}{[}\PYG{l+m+mf}{7.95685039}\PYG{p}{,} \PYG{l+m+mf}{9.31343712}\PYG{p}{,} \PYG{l+m+mf}{8.51048008}\PYG{p}{,} \PYG{l+m+mf}{9.18406086}\PYG{p}{,} \PYG{l+m+mf}{0.}        \PYG{p}{]}\PYG{p}{]}\PYG{p}{)}
\end{sphinxVerbatim}


\chapter{Clustering Analysis}
\label{\detokenize{usage/clustering_analysis_examples:clustering-analysis}}\label{\detokenize{usage/clustering_analysis_examples::doc}}

\section{Create signals for analysis}
\label{\detokenize{usage/clustering_analysis_examples:create-signals-for-analysis}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{from} \PYG{n+nn}{dtwhaclustering}\PYG{n+nn}{.}\PYG{n+nn}{dtw\PYGZus{}analysis} \PYG{k+kn}{import} \PYG{n}{dtw\PYGZus{}signal\PYGZus{}pairs}\PYG{p}{,} \PYG{n}{dtw\PYGZus{}clustering}\PYG{p}{,} \PYG{n}{plot\PYGZus{}signals}\PYG{p}{,} \PYG{n}{shuffle\PYGZus{}signals}\PYG{p}{,} \PYG{n}{plot\PYGZus{}cluster}
\PYG{k+kn}{import} \PYG{n+nn}{numpy} \PYG{k}{as} \PYG{n+nn}{np}
\PYG{k+kn}{from} \PYG{n+nn}{scipy} \PYG{k+kn}{import} \PYG{n}{signal}
\PYG{k+kn}{import} \PYG{n+nn}{matplotlib}\PYG{n+nn}{.}\PYG{n+nn}{pyplot} \PYG{k}{as} \PYG{n+nn}{plt}
\PYG{k+kn}{from} \PYG{n+nn}{dtaidistance} \PYG{k+kn}{import} \PYG{n}{dtw}
\PYG{k+kn}{from} \PYG{n+nn}{scipy}\PYG{n+nn}{.}\PYG{n+nn}{cluster}\PYG{n+nn}{.}\PYG{n+nn}{hierarchy} \PYG{k+kn}{import} \PYG{n}{fcluster}

\PYG{k+kn}{from} \PYG{n+nn}{scipy}\PYG{n+nn}{.}\PYG{n+nn}{cluster}\PYG{n+nn}{.}\PYG{n+nn}{hierarchy} \PYG{k+kn}{import} \PYG{n}{dendrogram}
\PYG{k+kn}{from} \PYG{n+nn}{sklearn}\PYG{n+nn}{.}\PYG{n+nn}{cluster} \PYG{k+kn}{import} \PYG{n}{AgglomerativeClustering}

\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{seed}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{} sampling parameters}
\PYG{n}{fs} \PYG{o}{=} \PYG{l+m+mi}{100}   \PYG{c+c1}{\PYGZsh{} sampling rate, in Hz}
\PYG{n}{T}  \PYG{o}{=} \PYG{l+m+mi}{1}      \PYG{c+c1}{\PYGZsh{} duration, in seconds}
\PYG{n}{N}  \PYG{o}{=} \PYG{n}{T} \PYG{o}{*} \PYG{n}{fs} \PYG{c+c1}{\PYGZsh{} duration, in samples}
\PYG{n}{M}  \PYG{o}{=} \PYG{l+m+mi}{5}      \PYG{c+c1}{\PYGZsh{} number of sources}
\PYG{n}{R}  \PYG{o}{=} \PYG{l+m+mi}{3}      \PYG{c+c1}{\PYGZsh{} number of copies}
\PYG{n}{MR} \PYG{o}{=} \PYG{n}{M} \PYG{o}{*} \PYG{n}{R}


\PYG{c+c1}{\PYGZsh{} time variable}
\PYG{n}{t} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{linspace}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{T}\PYG{p}{,} \PYG{n}{N}\PYG{p}{)}

\PYG{n}{S1} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sin}\PYG{p}{(}\PYG{l+m+mi}{2} \PYG{o}{*} \PYG{n}{np}\PYG{o}{.}\PYG{n}{pi} \PYG{o}{*} \PYG{n}{t} \PYG{o}{*} \PYG{l+m+mi}{7}\PYG{p}{)}
\PYG{n}{S2} \PYG{o}{=} \PYG{n}{signal}\PYG{o}{.}\PYG{n}{sawtooth}\PYG{p}{(}\PYG{l+m+mi}{2} \PYG{o}{*} \PYG{n}{np}\PYG{o}{.}\PYG{n}{pi} \PYG{o}{*} \PYG{n}{t} \PYG{o}{*} \PYG{l+m+mi}{5}\PYG{p}{)}
\PYG{n}{S3} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{abs}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{cos}\PYG{p}{(}\PYG{l+m+mi}{2} \PYG{o}{*} \PYG{n}{np}\PYG{o}{.}\PYG{n}{pi} \PYG{o}{*} \PYG{n}{t} \PYG{o}{*} \PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)} \PYG{o}{\PYGZhy{}} \PYG{l+m+mf}{0.5}
\PYG{n}{S4} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sign}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{sin}\PYG{p}{(}\PYG{l+m+mi}{2} \PYG{o}{*} \PYG{n}{np}\PYG{o}{.}\PYG{n}{pi} \PYG{o}{*} \PYG{n}{t} \PYG{o}{*} \PYG{l+m+mi}{8}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{S5} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{randn}\PYG{p}{(}\PYG{n}{N}\PYG{p}{)}

\PYG{n}{time\PYGZus{}series} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{n}{S1}\PYG{p}{,} \PYG{n}{S2}\PYG{p}{,} \PYG{n}{S3}\PYG{p}{,} \PYG{n}{S4}\PYG{p}{,} \PYG{n}{S5}\PYG{p}{]}\PYG{p}{)}

\PYG{n}{fig}\PYG{p}{,} \PYG{n}{ax} \PYG{o}{=} \PYG{n}{plot\PYGZus{}signals}\PYG{p}{(}\PYG{n}{time\PYGZus{}series}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{base_functions}.pdf}


\section{Add noise and make 3 copies of each signal}
\label{\detokenize{usage/clustering_analysis_examples:add-noise-and-make-3-copies-of-each-signal}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{SNR} \PYG{o}{=} \PYG{l+m+mf}{0.2}
\PYG{n}{X0} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{tile}\PYG{p}{(}\PYG{n}{S1}\PYG{p}{,} \PYG{p}{(}\PYG{n}{R}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{)} \PYG{o}{+} \PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{randn}\PYG{p}{(}\PYG{n}{R}\PYG{p}{,} \PYG{n}{N}\PYG{p}{)} \PYG{o}{*} \PYG{n}{SNR}
\PYG{n}{X1} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{tile}\PYG{p}{(}\PYG{n}{S2}\PYG{p}{,} \PYG{p}{(}\PYG{n}{R}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{)} \PYG{o}{+} \PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{randn}\PYG{p}{(}\PYG{n}{R}\PYG{p}{,} \PYG{n}{N}\PYG{p}{)} \PYG{o}{*} \PYG{n}{SNR}
\PYG{n}{X2} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{tile}\PYG{p}{(}\PYG{n}{S3}\PYG{p}{,} \PYG{p}{(}\PYG{n}{R}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{)} \PYG{o}{+} \PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{randn}\PYG{p}{(}\PYG{n}{R}\PYG{p}{,} \PYG{n}{N}\PYG{p}{)} \PYG{o}{*} \PYG{n}{SNR}
\PYG{n}{X3} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{tile}\PYG{p}{(}\PYG{n}{S4}\PYG{p}{,} \PYG{p}{(}\PYG{n}{R}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{)} \PYG{o}{+} \PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{randn}\PYG{p}{(}\PYG{n}{R}\PYG{p}{,} \PYG{n}{N}\PYG{p}{)} \PYG{o}{*} \PYG{n}{SNR}
\PYG{n}{X4} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{tile}\PYG{p}{(}\PYG{n}{S5}\PYG{p}{,} \PYG{p}{(}\PYG{n}{R}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{)} \PYG{o}{+} \PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{randn}\PYG{p}{(}\PYG{n}{R}\PYG{p}{,} \PYG{n}{N}\PYG{p}{)} \PYG{o}{*} \PYG{n}{SNR}
\PYG{n}{X} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{concatenate}\PYG{p}{(}\PYG{p}{(}\PYG{n}{X0}\PYG{p}{,} \PYG{n}{X1}\PYG{p}{,} \PYG{n}{X2}\PYG{p}{,} \PYG{n}{X3}\PYG{p}{,} \PYG{n}{X4}\PYG{p}{)}\PYG{p}{)}

\PYG{n}{color} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{C0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{*}\PYG{l+m+mi}{3}\PYG{o}{+}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{C1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{*}\PYG{l+m+mi}{3}\PYG{o}{+}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{C2}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{*}\PYG{l+m+mi}{3}\PYG{o}{+}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{C3}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{*}\PYG{l+m+mi}{3}\PYG{o}{+}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{C4}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{*}\PYG{l+m+mi}{3}
\PYG{n}{fig}\PYG{p}{,} \PYG{n}{ax} \PYG{o}{=} \PYG{n}{plot\PYGZus{}signals}\PYG{p}{(}\PYG{n}{X}\PYG{p}{,}\PYG{n}{figsize}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{10}\PYG{p}{,}\PYG{l+m+mi}{20}\PYG{p}{)}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{n}{color}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{noise_copies_signals}.png}


\section{Geographically distribute the signals}
\label{\detokenize{usage/clustering_analysis_examples:geographically-distribute-the-signals}}
\sphinxAtStartPar
Now, we have 15 signals in total. Let us also randomly make these signals distributed in geographical space by assigning them longitudes and latitudes. We assume that the signals with similar waveforms are geographically co\sphinxhyphen{}located.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{S0} \PYG{n}{variants} \PYG{p}{(}\PYG{n}{S0}\PYG{p}{,} \PYG{n}{S1}\PYG{p}{,} \PYG{n}{S2}\PYG{p}{)} \PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZgt{}} \PYG{n}{xrange}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{3}\PYG{p}{)} \PYG{n}{yrange}\PYG{p}{(}\PYG{l+m+mi}{7}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{10}\PYG{p}{)}
\PYG{n}{S1} \PYG{n}{variants} \PYG{p}{(}\PYG{n}{S3}\PYG{p}{,} \PYG{n}{S4}\PYG{p}{,} \PYG{n}{S5}\PYG{p}{)} \PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZgt{}} \PYG{n}{xrange}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{4}\PYG{p}{)} \PYG{n}{yrange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{5}\PYG{p}{)}
\PYG{n}{S2} \PYG{n}{variants} \PYG{p}{(}\PYG{n}{S6}\PYG{p}{,} \PYG{n}{S7}\PYG{p}{,} \PYG{n}{S8}\PYG{p}{)} \PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZgt{}} \PYG{n}{xrange}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{8}\PYG{p}{)} \PYG{n}{yrange}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{6}\PYG{p}{)}
\PYG{n}{S3} \PYG{n}{variants} \PYG{p}{(}\PYG{n}{S9}\PYG{p}{,} \PYG{n}{S10}\PYG{p}{,} \PYG{n}{S11}\PYG{p}{)} \PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZgt{}} \PYG{n}{xrange}\PYG{p}{(}\PYG{l+m+mi}{5}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{10}\PYG{p}{)} \PYG{n}{yrange}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{4}\PYG{p}{)}
\PYG{n}{S4} \PYG{n}{variants} \PYG{p}{(}\PYG{n}{S12}\PYG{p}{,} \PYG{n}{S13}\PYG{p}{,} \PYG{n}{S14}\PYG{p}{)} \PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZgt{}} \PYG{n}{xrange}\PYG{p}{(}\PYG{l+m+mi}{5}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{9}\PYG{p}{)} \PYG{n}{yrange}\PYG{p}{(}\PYG{l+m+mi}{6}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{9}\PYG{p}{)}
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{S0\PYGZus{}lons} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{uniform}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{l+m+mi}{3}\PYG{p}{,} \PYG{l+m+mi}{3}\PYG{p}{)}
\PYG{n}{S0\PYGZus{}lats} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{uniform}\PYG{p}{(}\PYG{l+m+mi}{7}\PYG{p}{,} \PYG{l+m+mi}{10}\PYG{p}{,} \PYG{l+m+mi}{3}\PYG{p}{)}

\PYG{n}{S1\PYGZus{}lons} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{uniform}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{4}\PYG{p}{,} \PYG{l+m+mi}{3}\PYG{p}{)}
\PYG{n}{S1\PYGZus{}lats} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{uniform}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,} \PYG{l+m+mi}{5}\PYG{p}{,} \PYG{l+m+mi}{3}\PYG{p}{)}

\PYG{n}{S2\PYGZus{}lons} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{uniform}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{,} \PYG{l+m+mi}{8}\PYG{p}{,} \PYG{l+m+mi}{3}\PYG{p}{)}
\PYG{n}{S2\PYGZus{}lats} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{uniform}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{,} \PYG{l+m+mi}{6}\PYG{p}{,} \PYG{l+m+mi}{3}\PYG{p}{)}

\PYG{n}{S3\PYGZus{}lons} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{uniform}\PYG{p}{(}\PYG{l+m+mi}{5}\PYG{p}{,} \PYG{l+m+mi}{10}\PYG{p}{,} \PYG{l+m+mi}{3}\PYG{p}{)}
\PYG{n}{S3\PYGZus{}lats} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{uniform}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{l+m+mi}{4}\PYG{p}{,} \PYG{l+m+mi}{3}\PYG{p}{)}

\PYG{n}{S3\PYGZus{}lons} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{uniform}\PYG{p}{(}\PYG{l+m+mi}{5}\PYG{p}{,} \PYG{l+m+mi}{10}\PYG{p}{,} \PYG{l+m+mi}{3}\PYG{p}{)}
\PYG{n}{S3\PYGZus{}lats} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{uniform}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{l+m+mi}{4}\PYG{p}{,} \PYG{l+m+mi}{3}\PYG{p}{)}

\PYG{n}{S4\PYGZus{}lons} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{uniform}\PYG{p}{(}\PYG{l+m+mi}{5}\PYG{p}{,} \PYG{l+m+mi}{9}\PYG{p}{,} \PYG{l+m+mi}{3}\PYG{p}{)}
\PYG{n}{S4\PYGZus{}lats} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{uniform}\PYG{p}{(}\PYG{l+m+mi}{6}\PYG{p}{,} \PYG{l+m+mi}{9}\PYG{p}{,} \PYG{l+m+mi}{3}\PYG{p}{)}

\PYG{n}{lons} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{concatenate}\PYG{p}{(}\PYG{p}{(}\PYG{n}{S0\PYGZus{}lons}\PYG{p}{,} \PYG{n}{S1\PYGZus{}lons}\PYG{p}{,} \PYG{n}{S2\PYGZus{}lons}\PYG{p}{,} \PYG{n}{S3\PYGZus{}lons}\PYG{p}{,} \PYG{n}{S4\PYGZus{}lons}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{lats} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{concatenate}\PYG{p}{(}\PYG{p}{(}\PYG{n}{S0\PYGZus{}lats}\PYG{p}{,} \PYG{n}{S1\PYGZus{}lats}\PYG{p}{,} \PYG{n}{S2\PYGZus{}lats}\PYG{p}{,} \PYG{n}{S3\PYGZus{}lats}\PYG{p}{,} \PYG{n}{S4\PYGZus{}lats}\PYG{p}{)}\PYG{p}{)}

\PYG{n}{plot\PYGZus{}cluster}\PYG{p}{(}\PYG{n}{lons}\PYG{p}{,}\PYG{n}{lats}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{} plt.show()}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{savefig}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{signals\PYGZus{}locations.pdf}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{bbox\PYGZus{}inches}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{tight}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{signals_locations}.pdf}


\section{Reshuffle the noisy signals}
\label{\detokenize{usage/clustering_analysis_examples:reshuffle-the-noisy-signals}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{shuffled\PYGZus{}idx}\PYG{p}{,} \PYG{n}{shuffled\PYGZus{}matrix} \PYG{o}{=} \PYG{n}{shuffle\PYGZus{}signals}\PYG{p}{(}\PYG{n}{X}\PYG{p}{,} \PYG{n}{labels}\PYG{o}{=}\PYG{p}{[}\PYG{p}{]}\PYG{p}{,} \PYG{n}{plot\PYGZus{}signals}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{,} \PYG{n}{figsize}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{10}\PYG{p}{,} \PYG{l+m+mi}{20}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{shuffled\PYGZus{}lons} \PYG{o}{=} \PYG{n}{lons}\PYG{p}{[}\PYG{n}{shuffled\PYGZus{}idx}\PYG{p}{]}
\PYG{n}{shuffled\PYGZus{}lats} \PYG{o}{=} \PYG{n}{lats}\PYG{p}{[}\PYG{n}{shuffled\PYGZus{}idx}\PYG{p}{]}

\PYG{n}{labels} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{S1a}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{S1b}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{S1c}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{S2a}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{S2b}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{S2c}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{S3a}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{S3b}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{S3c}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{S4a}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{S4b}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{S4c}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{S5a}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{S5b}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{S5c}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{newlabels} \PYG{o}{=} \PYG{n}{labels}\PYG{p}{[}\PYG{n}{shuffled\PYGZus{}idx}\PYG{p}{]}

\PYG{n}{color} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{n}{color}\PYG{p}{)}
\PYG{n}{color} \PYG{o}{=} \PYG{n}{color}\PYG{p}{[}\PYG{n}{shuffled\PYGZus{}idx}\PYG{p}{]}
\PYG{n}{fig}\PYG{p}{,} \PYG{n}{ax} \PYG{o}{=} \PYG{n}{plot\PYGZus{}signals}\PYG{p}{(}\PYG{n}{shuffled\PYGZus{}matrix}\PYG{p}{,}\PYG{n}{figsize}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{10}\PYG{p}{,}\PYG{l+m+mi}{20}\PYG{p}{)}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{n}{color}\PYG{p}{,} \PYG{n}{labels}\PYG{o}{=}\PYG{n}{newlabels}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{savefig}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{shuffled\PYGZus{}signals.pdf}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{bbox\PYGZus{}inches}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{tight}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{shuffled_signals}.pdf}


\section{Cluster reshuffled signals}
\label{\detokenize{usage/clustering_analysis_examples:cluster-reshuffled-signals}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{dtw\PYGZus{}cluster2} \PYG{o}{=} \PYG{n}{dtw\PYGZus{}clustering}\PYG{p}{(}\PYG{n}{shuffled\PYGZus{}matrix}\PYG{p}{,} \PYG{n}{labels}\PYG{o}{=}\PYG{n}{newlabels}\PYG{p}{,} \PYG{n}{longitudes}\PYG{o}{=}\PYG{n}{shuffled\PYGZus{}lons}\PYG{p}{,} \PYG{n}{latitudes}\PYG{o}{=}\PYG{n}{shuffled\PYGZus{}lats}\PYG{p}{)}
\PYG{n}{dtw\PYGZus{}cluster2}\PYG{o}{.}\PYG{n}{plot\PYGZus{}dendrogram}\PYG{p}{(}\PYG{n}{annotate\PYGZus{}above}\PYG{o}{=}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{n}{xlabel}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Signals}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{figname}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{example\PYGZus{}dtw\PYGZus{}cluster.png}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}\PYG{n}{distance\PYGZus{}threshold}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{optimal}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{example_dtw_cluster}.pdf}

\sphinxAtStartPar
In the above dendrogram, we manually selected the threshold distance to be 3 to find the best clusters


\section{Plot the geographical locations of the clusters}
\label{\detokenize{usage/clustering_analysis_examples:plot-the-geographical-locations-of-the-clusters}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{dtw\PYGZus{}cluster2}\PYG{o}{.}\PYG{n}{plot\PYGZus{}cluster\PYGZus{}xymap}\PYG{p}{(}\PYG{n}{dtw\PYGZus{}distance}\PYG{o}{=}\PYG{l+m+mi}{3}\PYG{p}{,} \PYG{n}{figname}\PYG{o}{=}\PYG{k+kc}{None}\PYG{p}{,} \PYG{n}{xlabel}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{ylabel}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{40}\PYG{p}{,} \PYG{n}{markersize}\PYG{o}{=}\PYG{l+m+mi}{200}\PYG{p}{,} \PYG{n}{tickfontsize}\PYG{o}{=}\PYG{l+m+mi}{30}\PYG{p}{,} \PYG{n}{cbarsize}\PYG{o}{=}\PYG{l+m+mi}{40}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{savefig}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{signals\PYGZus{}cluster\PYGZus{}xy\PYGZus{}map.pdf}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{bbox\PYGZus{}inches}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{tight}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{edgecolors}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{black}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{linewidths}\PYG{o}{=}\PYG{l+m+mi}{5}\PYG{p}{)}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{signals_cluster_xy_map}.pdf}


\section{Polar dendrogram}
\label{\detokenize{usage/clustering_analysis_examples:polar-dendrogram}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{kwargs\PYGZus{}dendro}\PYG{o}{=}\PYG{p}{\PYGZob{}}
\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{plotstyle}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{seaborn}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{linewidth}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:}\PYG{l+m+mi}{5}\PYG{p}{,}
\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{gridwidth}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:}\PYG{l+m+mf}{0.8}\PYG{p}{,}
\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{gridcolor}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{gray}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{xtickfontsize}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:}\PYG{l+m+mi}{60}\PYG{p}{,}
\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{ytickfontsize}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:}\PYG{l+m+mi}{60}\PYG{p}{,}
\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{figsize}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:}\PYG{p}{(}\PYG{l+m+mi}{40}\PYG{p}{,}\PYG{l+m+mi}{40}\PYG{p}{)}\PYG{p}{,}
\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{distance\PYGZus{}threshold}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{optimal}\PYG{l+s+s2}{\PYGZdq{}} \PYG{c+c1}{\PYGZsh{}use optimal number of clusters estimated by elbow method}
\PYG{p}{\PYGZcb{}}

\PYG{n}{dtw\PYGZus{}cluster2}\PYG{o}{.}\PYG{n}{plot\PYGZus{}polar\PYGZus{}dendrogram}\PYG{p}{(}\PYG{o}{*}\PYG{o}{*}\PYG{n}{kwargs\PYGZus{}dendro}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{savefig}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{example\PYGZus{}polar\PYGZus{}dendro.pdf}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{bbox\PYGZus{}inches}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{tight}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{example_polar_dendro}.pdf}


\section{How the DTW distance changes with iterations to obtain the dendrogram?}
\label{\detokenize{usage/clustering_analysis_examples:how-the-dtw-distance-changes-with-iterations-to-obtain-the-dendrogram}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{dtw\PYGZus{}cluster2}\PYG{o}{.}\PYG{n}{plot\PYGZus{}hac\PYGZus{}iteration}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{plot_hac_iteration}.pdf}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{dtw\PYGZus{}cluster2}\PYG{o}{.}\PYG{n}{plot\PYGZus{}optimum\PYGZus{}cluster}\PYG{p}{(}\PYG{n}{legend\PYGZus{}outside}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{savefig}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{optimum\PYGZus{}clusters.pdf}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{bbox\PYGZus{}inches}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{tight}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{optimum_clusters}.pdf}


\section{Euclidean distance\sphinxhyphen{}based cluster}
\label{\detokenize{usage/clustering_analysis_examples:euclidean-distance-based-cluster}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{def} \PYG{n+nf}{compute\PYGZus{}linkage}\PYG{p}{(}\PYG{n}{model}\PYG{p}{)}\PYG{p}{:}
    \PYG{c+c1}{\PYGZsh{} create the counts of samples under each node}
    \PYG{n}{counts} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{zeros}\PYG{p}{(}\PYG{n}{model}\PYG{o}{.}\PYG{n}{children\PYGZus{}}\PYG{o}{.}\PYG{n}{shape}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{)}
    \PYG{n}{n\PYGZus{}samples} \PYG{o}{=} \PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{model}\PYG{o}{.}\PYG{n}{labels\PYGZus{}}\PYG{p}{)}
    \PYG{k}{for} \PYG{n}{i}\PYG{p}{,} \PYG{n}{merge} \PYG{o+ow}{in} \PYG{n+nb}{enumerate}\PYG{p}{(}\PYG{n}{model}\PYG{o}{.}\PYG{n}{children\PYGZus{}}\PYG{p}{)}\PYG{p}{:}
        \PYG{n}{current\PYGZus{}count} \PYG{o}{=} \PYG{l+m+mi}{0}
        \PYG{k}{for} \PYG{n}{child\PYGZus{}idx} \PYG{o+ow}{in} \PYG{n}{merge}\PYG{p}{:}
            \PYG{k}{if} \PYG{n}{child\PYGZus{}idx} \PYG{o}{\PYGZlt{}} \PYG{n}{n\PYGZus{}samples}\PYG{p}{:}
                \PYG{n}{current\PYGZus{}count} \PYG{o}{+}\PYG{o}{=} \PYG{l+m+mi}{1}  \PYG{c+c1}{\PYGZsh{} leaf node}
            \PYG{k}{else}\PYG{p}{:}
                \PYG{n}{current\PYGZus{}count} \PYG{o}{+}\PYG{o}{=} \PYG{n}{counts}\PYG{p}{[}\PYG{n}{child\PYGZus{}idx} \PYG{o}{\PYGZhy{}} \PYG{n}{n\PYGZus{}samples}\PYG{p}{]}
        \PYG{n}{counts}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]} \PYG{o}{=} \PYG{n}{current\PYGZus{}count}

    \PYG{n}{linkage\PYGZus{}matrix} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{column\PYGZus{}stack}\PYG{p}{(}\PYG{p}{[}\PYG{n}{model}\PYG{o}{.}\PYG{n}{children\PYGZus{}}\PYG{p}{,} \PYG{n}{model}\PYG{o}{.}\PYG{n}{distances\PYGZus{}}\PYG{p}{,}
                                    \PYG{n}{counts}\PYG{p}{]}\PYG{p}{)}\PYG{o}{.}\PYG{n}{astype}\PYG{p}{(}\PYG{n+nb}{float}\PYG{p}{)}
    \PYG{k}{return} \PYG{n}{linkage\PYGZus{}matrix}

\PYG{k}{def} \PYG{n+nf}{plot\PYGZus{}dendrogram}\PYG{p}{(}\PYG{n}{model}\PYG{p}{,} \PYG{o}{*}\PYG{o}{*}\PYG{n}{kwargs}\PYG{p}{)}\PYG{p}{:}
    \PYG{c+c1}{\PYGZsh{} Create linkage matrix and then plot the dendrogram}

    \PYG{n}{linkage\PYGZus{}matrix} \PYG{o}{=} \PYG{n}{compute\PYGZus{}linkage}\PYG{p}{(}\PYG{n}{model}\PYG{p}{)}

    \PYG{c+c1}{\PYGZsh{} Plot the corresponding dendrogram}
    \PYG{n}{dendrogram}\PYG{p}{(}\PYG{n}{linkage\PYGZus{}matrix}\PYG{p}{,} \PYG{o}{*}\PYG{o}{*}\PYG{n}{kwargs}\PYG{p}{)}


\PYG{c+c1}{\PYGZsh{}‘ward’ minimizes the variance of the clusters being merged}
\PYG{n}{model} \PYG{o}{=} \PYG{n}{AgglomerativeClustering}\PYG{p}{(}\PYG{n}{distance\PYGZus{}threshold}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{n\PYGZus{}clusters}\PYG{o}{=}\PYG{k+kc}{None}\PYG{p}{,} \PYG{n}{affinity}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{euclidean}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{linkage}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{ward}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}

\PYG{n}{model} \PYG{o}{=} \PYG{n}{model}\PYG{o}{.}\PYG{n}{fit}\PYG{p}{(}\PYG{n}{X}\PYG{p}{)}

\PYG{n}{plt}\PYG{o}{.}\PYG{n}{figure}\PYG{p}{(}\PYG{n}{figsize}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{20}\PYG{p}{,} \PYG{l+m+mi}{8}\PYG{p}{)}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{} plot the top three levels of the dendrogram}
\PYG{n}{plot\PYGZus{}dendrogram}\PYG{p}{(}\PYG{n}{model}\PYG{p}{,} \PYG{n}{p}\PYG{o}{=}\PYG{l+m+mi}{5}\PYG{p}{,} \PYG{n}{color\PYGZus{}threshold}\PYG{o}{=}\PYG{l+m+mi}{5}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{xticks}\PYG{p}{(}\PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{26}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{yticks}\PYG{p}{(}\PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{26}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{axhline}\PYG{p}{(}\PYG{n}{y}\PYG{o}{=}\PYG{l+m+mi}{5}\PYG{p}{,} \PYG{n}{c}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{k}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}


\PYG{n}{plt}\PYG{o}{.}\PYG{n}{xlabel}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Signal Indexes}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{savefig}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{example\PYGZus{}euclidean\PYGZus{}cluster.pdf}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{bbox\PYGZus{}inches}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{tight}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{close}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{example_euclidean_cluster}.pdf}

\sphinxAtStartPar
Both Euclidean and DTW based clustering results are similar. However, we can see some obvious differences. Let us list some of the similarity and differences for the above example.
\begin{itemize}
\item {} 
\sphinxAtStartPar
Both the results found 5 significant clusters.

\item {} 
\sphinxAtStartPar
Both Euclidean and DTW based HAC found that the random function based time series (12, 13, 14) are most dissimilar

\item {} 
\sphinxAtStartPar
The two closest clusters with DTW is sawtooth (6,7,8) and sine func(0,1,2). While that with the Euclidean, it is abs\_cosine (6,7,8) and sawtooth fn (3,4,5)

\end{itemize}

\sphinxAtStartPar
The two results are similar because the signals considered for this example are stationary in nature.


\chapter{dtwhaclustering.analysis\_support}
\label{\detokenize{modules/analysis_support:module-dtwhaclustering.analysis_support}}\label{\detokenize{modules/analysis_support:dtwhaclustering-analysis-support}}\label{\detokenize{modules/analysis_support::doc}}\index{module@\spxentry{module}!dtwhaclustering.analysis\_support@\spxentry{dtwhaclustering.analysis\_support}}\index{dtwhaclustering.analysis\_support@\spxentry{dtwhaclustering.analysis\_support}!module@\spxentry{module}}
\sphinxAtStartPar
DTW HAC analysis support functions (\sphinxtitleref{analysis\_support})
\begin{quote}\begin{description}
\item[{author}] \leavevmode
\sphinxAtStartPar
Utpal Kumar, Institute of Earth Sciences, Academia Sinica

\end{description}\end{quote}
\index{dec2dt() (in module dtwhaclustering.analysis\_support)@\spxentry{dec2dt()}\spxextra{in module dtwhaclustering.analysis\_support}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules/analysis_support:dtwhaclustering.analysis_support.dec2dt}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{dtwhaclustering.analysis\_support.}}\sphinxbfcode{\sphinxupquote{dec2dt}}}{\emph{\DUrole{n}{start}}}{}
\sphinxAtStartPar
Convert the decimal type time array to the date\sphinxhyphen{}time type array
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{start}} (\sphinxstyleliteralemphasis{\sphinxupquote{list}}) \textendash{} list or numpy array of decimal year values e.g., {[}2020.001{]}

\item[{Returns}] \leavevmode
\sphinxAtStartPar
date\sphinxhyphen{}time type array

\item[{Return type}] \leavevmode
\sphinxAtStartPar
list

\end{description}\end{quote}

\end{fulllineitems}

\index{dec2dt\_scalar() (in module dtwhaclustering.analysis\_support)@\spxentry{dec2dt\_scalar()}\spxextra{in module dtwhaclustering.analysis\_support}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules/analysis_support:dtwhaclustering.analysis_support.dec2dt_scalar}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{dtwhaclustering.analysis\_support.}}\sphinxbfcode{\sphinxupquote{dec2dt\_scalar}}}{\emph{\DUrole{n}{st}}}{}
\sphinxAtStartPar
Convert the decimal type time value to the date\sphinxhyphen{}time type
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{st}} \textendash{} scalar decimal year value e.g., 2020.001

\item[{Returns}] \leavevmode
\sphinxAtStartPar
time as datetime type

\item[{Return type}] \leavevmode
\sphinxAtStartPar
str

\end{description}\end{quote}

\end{fulllineitems}

\index{toYearFraction() (in module dtwhaclustering.analysis\_support)@\spxentry{toYearFraction()}\spxextra{in module dtwhaclustering.analysis\_support}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules/analysis_support:dtwhaclustering.analysis_support.toYearFraction}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{dtwhaclustering.analysis\_support.}}\sphinxbfcode{\sphinxupquote{toYearFraction}}}{\emph{\DUrole{n}{date}}}{}
\sphinxAtStartPar
Convert the date\sphinxhyphen{}time type object to decimal year
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{date}} \textendash{} the date\sphinxhyphen{}time type object

\item[{Returns}] \leavevmode
\sphinxAtStartPar
decimal year

\item[{Return type}] \leavevmode
\sphinxAtStartPar
float

\end{description}\end{quote}

\end{fulllineitems}



\chapter{dtwhaclustering.plot\_linear\_trend}
\label{\detokenize{modules/plot_linear_trend:module-dtwhaclustering.plot_linear_trend}}\label{\detokenize{modules/plot_linear_trend:dtwhaclustering-plot-linear-trend}}\label{\detokenize{modules/plot_linear_trend::doc}}\index{module@\spxentry{module}!dtwhaclustering.plot\_linear\_trend@\spxentry{dtwhaclustering.plot\_linear\_trend}}\index{dtwhaclustering.plot\_linear\_trend@\spxentry{dtwhaclustering.plot\_linear\_trend}!module@\spxentry{module}}
\sphinxAtStartPar
Plot linear trend values on a geographical map
\begin{quote}\begin{description}
\item[{author}] \leavevmode
\sphinxAtStartPar
Utpal Kumar, Institute of Earth Sciences, Academia Sinica

\end{description}\end{quote}
\index{compute\_interpolation() (in module dtwhaclustering.plot\_linear\_trend)@\spxentry{compute\_interpolation()}\spxextra{in module dtwhaclustering.plot\_linear\_trend}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules/plot_linear_trend:dtwhaclustering.plot_linear_trend.compute_interpolation}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{dtwhaclustering.plot\_linear\_trend.}}\sphinxbfcode{\sphinxupquote{compute\_interpolation}}}{\emph{\DUrole{n}{df}}, \emph{\DUrole{n}{method}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}nearest\textquotesingle{}}}, \emph{\DUrole{n}{lonrange}\DUrole{o}{=}\DUrole{default_value}{(120.0, 122.0)}}, \emph{\DUrole{n}{latrange}\DUrole{o}{=}\DUrole{default_value}{(21.8, 25.6)}}, \emph{\DUrole{n}{step}\DUrole{o}{=}\DUrole{default_value}{0.01}}}{}
\sphinxAtStartPar
Interpolate linear trend values using Scipy’s griddata and returns xarray object
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{df}} (\sphinxstyleliteralemphasis{\sphinxupquote{pandas.DataFrame}}) \textendash{} pandas dataframe containing the columns \sphinxtitleref{lon}, \sphinxtitleref{lat} and \sphinxtitleref{slope}

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{method}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} Method of interpolation. One of \{‘linear’, ‘nearest’, ‘cubic’\}. For more, see \sphinxtitleref{scipy.interpolate.griddata}

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{lonrange}} (\sphinxstyleliteralemphasis{\sphinxupquote{tuple}}) \textendash{} minimum and maximum values of the longitude to be interpolated

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{latrange}} (\sphinxstyleliteralemphasis{\sphinxupquote{tuple}}) \textendash{} minimum and maximum values of the latitude to be interpolated

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{step}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}) \textendash{} stepsize to interpolate data spatially

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxAtStartPar
\sphinxtitleref{xarray.DataArray} of dims, and coords (“lat”, “long”), maximum of the absolute interpolated array values

\end{description}\end{quote}

\end{fulllineitems}

\index{plot\_linear\_trend\_on\_map() (in module dtwhaclustering.plot\_linear\_trend)@\spxentry{plot\_linear\_trend\_on\_map()}\spxextra{in module dtwhaclustering.plot\_linear\_trend}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules/plot_linear_trend:dtwhaclustering.plot_linear_trend.plot_linear_trend_on_map}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{dtwhaclustering.plot\_linear\_trend.}}\sphinxbfcode{\sphinxupquote{plot\_linear\_trend\_on\_map}}}{\emph{\DUrole{n}{df}}, \emph{\DUrole{n}{maplonrange}\DUrole{o}{=}\DUrole{default_value}{(120.0, 122.1)}}, \emph{\DUrole{n}{maplatrange}\DUrole{o}{=}\DUrole{default_value}{(21.8, 25.6)}}, \emph{\DUrole{n}{intrp\_lonrange}\DUrole{o}{=}\DUrole{default_value}{(120.0, 122.0)}}, \emph{\DUrole{n}{intrp\_latrange}\DUrole{o}{=}\DUrole{default_value}{(21.8, 25.6)}}, \emph{\DUrole{n}{outfig}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}Maps/slope\sphinxhyphen{}plot.png\textquotesingle{}}}, \emph{\DUrole{n}{frame}\DUrole{o}{=}\DUrole{default_value}{{[}\textquotesingle{}a1f0.25\textquotesingle{}, \textquotesingle{}WSen\textquotesingle{}{]}}}, \emph{\DUrole{n}{cmap}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}jet\textquotesingle{}}}, \emph{\DUrole{n}{step}\DUrole{o}{=}\DUrole{default_value}{0.01}}, \emph{\DUrole{n}{stn\_labels}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{n}{justify}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}left\textquotesingle{}}}, \emph{\DUrole{n}{labelfont}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}6p,Helvetica\sphinxhyphen{}Bold,black\textquotesingle{}}}, \emph{\DUrole{n}{offset}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}5p/\sphinxhyphen{}5p\textquotesingle{}}}, \emph{\DUrole{n}{markerstyle}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}i10p\textquotesingle{}}}, \emph{\DUrole{n}{defpen}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}1p,black\textquotesingle{}}}, \emph{\DUrole{n}{stn\_labels\_color}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}black\textquotesingle{}}}, \emph{\DUrole{n}{rand\_justify}\DUrole{o}{=}\DUrole{default_value}{False}}, \emph{\DUrole{n}{water\_color}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}skyblue\textquotesingle{}}}}{}
\sphinxAtStartPar
Plot the interpolated linear trend values along with the original data points on a geographical map using PyGMT
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{df}} (\sphinxstyleliteralemphasis{\sphinxupquote{pandas.DataFrame}}) \textendash{} Pandas dataframe containing the columns \sphinxtitleref{lon}, \sphinxtitleref{lat} and \sphinxtitleref{slope}

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{maplonrange}} (\sphinxstyleliteralemphasis{\sphinxupquote{tuple}}) \textendash{} longitude min/max of the output map

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{maplatrange}} (\sphinxstyleliteralemphasis{\sphinxupquote{tuple}}) \textendash{} latitude min/max of the output map

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{intrp\_lonrange}} (\sphinxstyleliteralemphasis{\sphinxupquote{tuple}}) \textendash{} longitude min/max for the interpolation of data

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{intrp\_latrange}} (\sphinxstyleliteralemphasis{\sphinxupquote{tuple}}) \textendash{} latitude min/max for the interpolation of data

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{step}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}) \textendash{} resolution of the interpolation

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{cmap}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} colormap for the output map

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{frame}} (\sphinxstyleliteralemphasis{\sphinxupquote{list}}) \textendash{} frame of the output map. See PyGMT docs for details

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{outfig}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} output figure name with extension, e.g., \sphinxtitleref{slope\sphinxhyphen{}plot.png}

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{water\_color}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} color of the water, default: skyblue

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{stn\_labels}} (\sphinxstyleliteralemphasis{\sphinxupquote{array}}) \textendash{} label the station names. Only the stations provided will be labeled

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{justify}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} justification of the station labels \sphinxhyphen{} ‘left’, ‘right’

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{rand\_justify}} (\sphinxstyleliteralemphasis{\sphinxupquote{boolean}}) \textendash{} randomly decide the justification for each labels

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{markerstyle}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} marker style and size

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxAtStartPar
None

\end{description}\end{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{kwargs}\PYG{o}{=}\PYG{p}{\PYGZob{}}
    \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{labelfont}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{16p,Helvetica\PYGZhy{}Bold,black}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
    \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{justify}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{right}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
    \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{offset}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZhy{}10p/\PYGZhy{}1p}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
    \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{maplonrange}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:}\PYG{p}{(}\PYG{l+m+mf}{119.8}\PYG{p}{,} \PYG{l+m+mf}{122.1}\PYG{p}{)}\PYG{p}{,} 
    \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{maplatrange}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:}\PYG{p}{(}\PYG{l+m+mf}{21.8}\PYG{p}{,} \PYG{l+m+mf}{25.6}\PYG{p}{)}\PYG{p}{,}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{markerstyle}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{i16p}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{rand\PYGZus{}justify}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:}\PYG{k+kc}{True}\PYG{p}{,}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{water\PYGZus{}color}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{gray}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{p}{\PYGZcb{}}
\PYG{n}{comp} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{U}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{n}{all\PYGZus{}labels} \PYG{o}{=} \PYG{p}{\PYGZob{}}\PYG{p}{\PYGZcb{}}
\PYG{n}{all\PYGZus{}labels}\PYG{p}{[}\PYG{n}{comp}\PYG{p}{]} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PKGM}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{YMSM}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{VR02}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{HUWE}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{LNCH}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{CHEN}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{TUNH}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}

\PYG{n}{slopeFile}\PYG{o}{=}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{stn\PYGZus{}slope\PYGZus{}res\PYGZus{}}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{comp}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s1}{.txt}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{df} \PYG{o}{=} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{read\PYGZus{}csv}\PYG{p}{(}\PYG{n}{slopeFile}\PYG{p}{,} \PYG{n}{names}\PYG{o}{=}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{stn}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lon}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{slope}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,} \PYG{n}{delimiter}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZbs{}}\PYG{l+s+s1}{s+}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{figname} \PYG{o}{=} \PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{outloc}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{/slope\PYGZhy{}plot\PYGZus{}}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{comp}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{.png}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{n}{plot\PYGZus{}linear\PYGZus{}trend\PYGZus{}on\PYGZus{}map}\PYG{p}{(}\PYG{n}{df}\PYG{p}{,} \PYG{n}{outfig}\PYG{o}{=}\PYG{n}{figname}\PYG{p}{,}\PYG{n}{stn\PYGZus{}labels}\PYG{o}{=}\PYG{n}{all\PYGZus{}labels}\PYG{p}{[}\PYG{n}{comp}\PYG{p}{]}\PYG{p}{,} \PYG{o}{*}\PYG{o}{*}\PYG{n}{kwargs}\PYG{p}{)}
\end{sphinxVerbatim}

\end{fulllineitems}



\chapter{dtwhaclustering.leastSquareModeling}
\label{\detokenize{modules/leastSquareModeling:module-dtwhaclustering.leastSquareModeling}}\label{\detokenize{modules/leastSquareModeling:dtwhaclustering-leastsquaremodeling}}\label{\detokenize{modules/leastSquareModeling::doc}}\index{module@\spxentry{module}!dtwhaclustering.leastSquareModeling@\spxentry{dtwhaclustering.leastSquareModeling}}\index{dtwhaclustering.leastSquareModeling@\spxentry{dtwhaclustering.leastSquareModeling}!module@\spxentry{module}}
\sphinxAtStartPar
Least square modeling of GPS displacements for seasonality, tidal, co\sphinxhyphen{}seismic jumps.
\begin{quote}\begin{description}
\item[{author}] \leavevmode
\sphinxAtStartPar
Utpal Kumar, Institute of Earth Sciences, Academia Sinica

\end{description}\end{quote}
\index{LSQmodules (class in dtwhaclustering.leastSquareModeling)@\spxentry{LSQmodules}\spxextra{class in dtwhaclustering.leastSquareModeling}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules/leastSquareModeling:dtwhaclustering.leastSquareModeling.LSQmodules}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{class }}\sphinxcode{\sphinxupquote{dtwhaclustering.leastSquareModeling.}}\sphinxbfcode{\sphinxupquote{LSQmodules}}}{\emph{\DUrole{n}{dUU}}, \emph{\DUrole{n}{sel\_eq\_file}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{n}{station\_loc\_file}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}helper\_files/stn\_loc.txt\textquotesingle{}}}, \emph{\DUrole{n}{comp}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}U\textquotesingle{}}}, \emph{\DUrole{n}{figdir}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}LSQOut\textquotesingle{}}}, \emph{\DUrole{n}{periods}\DUrole{o}{=}\DUrole{default_value}{(13.6608, 14.7653, 27.5546, 182.62, 365.26, 6793.836)}}}{}
\sphinxAtStartPar
Bases: \sphinxcode{\sphinxupquote{object}}
\index{compute\_lsq() (dtwhaclustering.leastSquareModeling.LSQmodules method)@\spxentry{compute\_lsq()}\spxextra{dtwhaclustering.leastSquareModeling.LSQmodules method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules/leastSquareModeling:dtwhaclustering.leastSquareModeling.LSQmodules.compute_lsq}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{compute\_lsq}}}{\emph{\DUrole{n}{plot\_results}\DUrole{o}{=}\DUrole{default_value}{False}}, \emph{\DUrole{n}{remove\_trend}\DUrole{o}{=}\DUrole{default_value}{True}}, \emph{\DUrole{n}{remove\_seasonality}\DUrole{o}{=}\DUrole{default_value}{True}}, \emph{\DUrole{n}{remove\_jumps}\DUrole{o}{=}\DUrole{default_value}{True}}, \emph{\DUrole{n}{plotformat}\DUrole{o}{=}\DUrole{default_value}{None}}}{}
\sphinxAtStartPar
Compute the least\sphinxhyphen{}squares model using multithreading
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{plot\_results}} (\sphinxstyleliteralemphasis{\sphinxupquote{boolean}}) \textendash{} plot the final results

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{remove\_trend}} (\sphinxstyleliteralemphasis{\sphinxupquote{boolean}}) \textendash{} return the time series after removing the linear trend

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{remove\_seasonality}} (\sphinxstyleliteralemphasis{\sphinxupquote{boolean}}) \textendash{} return the time series after removing the seasonal signals

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{remove\_jumps}} (\sphinxstyleliteralemphasis{\sphinxupquote{boolean}}) \textendash{} return the time series after removing the co\sphinxhyphen{}seismic jumps

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{plotformat}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} plot format of the output figure, e.g. “png”. “pdf” by default.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{jump() (dtwhaclustering.leastSquareModeling.LSQmodules method)@\spxentry{jump()}\spxextra{dtwhaclustering.leastSquareModeling.LSQmodules method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules/leastSquareModeling:dtwhaclustering.leastSquareModeling.LSQmodules.jump}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{jump}}}{\emph{\DUrole{n}{t}}, \emph{\DUrole{n}{t0}}}{}
\sphinxAtStartPar
heaviside step function
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{t}} (\sphinxstyleliteralemphasis{\sphinxupquote{list}}) \textendash{} time data

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{t0}} \textendash{} earthquake origin time

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{lsqmodeling() (in module dtwhaclustering.leastSquareModeling)@\spxentry{lsqmodeling()}\spxextra{in module dtwhaclustering.leastSquareModeling}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules/leastSquareModeling:dtwhaclustering.leastSquareModeling.lsqmodeling}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{dtwhaclustering.leastSquareModeling.}}\sphinxbfcode{\sphinxupquote{lsqmodeling}}}{\emph{\DUrole{n}{dUU}}, \emph{\DUrole{n}{dNN}}, \emph{\DUrole{n}{dEE}}, \emph{\DUrole{n}{stnlocfile}}, \emph{\DUrole{n}{plot\_results}\DUrole{o}{=}\DUrole{default_value}{True}}, \emph{\DUrole{n}{remove\_trend}\DUrole{o}{=}\DUrole{default_value}{False}}, \emph{\DUrole{n}{remove\_seasonality}\DUrole{o}{=}\DUrole{default_value}{True}}, \emph{\DUrole{n}{remove\_jumps}\DUrole{o}{=}\DUrole{default_value}{False}}, \emph{\DUrole{n}{sel\_eq\_file}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}helper\_files/selected\_eqs\_new.txt\textquotesingle{}}}, \emph{\DUrole{n}{figdir}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}LSQOut\textquotesingle{}}}}{}
\sphinxAtStartPar
Least square modeling for the three component time series
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{dUU}} (\sphinxstyleliteralemphasis{\sphinxupquote{pandas.DataFrame}}) \textendash{} Vertical component pandas dataframe time series

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{dNN}} (\sphinxstyleliteralemphasis{\sphinxupquote{pandas.DataFrame}}) \textendash{} North component pandas dataframe time series

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{dEE}} (\sphinxstyleliteralemphasis{\sphinxupquote{pandas.DataFrame}}) \textendash{} East component pandas dataframe time series

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{plot\_results}} (\sphinxstyleliteralemphasis{\sphinxupquote{boolean}}) \textendash{} plot the final results

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{remove\_trend}} (\sphinxstyleliteralemphasis{\sphinxupquote{boolean}}) \textendash{} return the time series after removing the linear trend

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{remove\_seasonality}} (\sphinxstyleliteralemphasis{\sphinxupquote{boolean}}) \textendash{} return the time series after removing the seasonal signals

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{remove\_jumps}} (\sphinxstyleliteralemphasis{\sphinxupquote{boolean}}) \textendash{} return the time series after removing the co\sphinxhyphen{}seismic jumps

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{sel\_eq\_file}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} File containing the earthquake origin times e.g., \sphinxtitleref{2009,1,15} with header info, e.g. \sphinxtitleref{year\_val,month\_val,date\_val}

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{stnlocfile}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} File containing the station location info, e.g., \sphinxtitleref{DAWU,120.89004,22.34059}, with header \sphinxtitleref{stn,lon,lat}

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxAtStartPar
Pandas dataframe corresponding to the vertical, north and east components e.g., final\_dU, final\_dN, final\_dE

\item[{Return type}] \leavevmode
\sphinxAtStartPar
pandas.DataFrame, pandas.DataFrame, pandas.DataFrame

\end{description}\end{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{from} \PYG{n+nn}{dtwhaclustering}\PYG{n+nn}{.}\PYG{n+nn}{leastSquareModeling} \PYG{k+kn}{import} \PYG{n}{lsqmodeling}
\PYG{n}{final\PYGZus{}dU}\PYG{p}{,} \PYG{n}{final\PYGZus{}dN}\PYG{p}{,} \PYG{n}{final\PYGZus{}dE} \PYG{o}{=} \PYG{n}{lsqmodeling}\PYG{p}{(}\PYG{n}{dUU}\PYG{p}{,} \PYG{n}{dNN}\PYG{p}{,} \PYG{n}{dEE}\PYG{p}{,}\PYG{n}{stnlocfile}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{helper\PYGZus{}files/stn\PYGZus{}loc.txt}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}  \PYG{n}{plot\PYGZus{}results}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{,} \PYG{n}{remove\PYGZus{}trend}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{,} \PYG{n}{remove\PYGZus{}seasonality}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{,} \PYG{n}{remove\PYGZus{}jumps}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{)}
\end{sphinxVerbatim}

\end{fulllineitems}



\chapter{dtwhaclustering.dtw\_analysis}
\label{\detokenize{modules/dtw_analysis:module-dtwhaclustering.dtw_analysis}}\label{\detokenize{modules/dtw_analysis:dtwhaclustering-dtw-analysis}}\label{\detokenize{modules/dtw_analysis::doc}}\index{module@\spxentry{module}!dtwhaclustering.dtw\_analysis@\spxentry{dtwhaclustering.dtw\_analysis}}\index{dtwhaclustering.dtw\_analysis@\spxentry{dtwhaclustering.dtw\_analysis}!module@\spxentry{module}}
\sphinxAtStartPar
Classes and functions for the DTW analysis and plotting maps and figures (\sphinxtitleref{dtw\_analysis})
This module is built around the dtaidistance package for the DTW computation and scipy.cluster
\begin{quote}\begin{description}
\item[{author}] \leavevmode
\sphinxAtStartPar
Utpal Kumar, Institute of Earth Sciences, Academia Sinica

\item[{note}] \leavevmode
\sphinxAtStartPar
See \sphinxhref{https://dtaidistance.readthedocs.io/en/latest/usage/dtw.html}{dtaidistance} for details on HierarchicalTree, dtw, dtw\_visualisation

\end{description}\end{quote}
\index{dtw\_clustering (class in dtwhaclustering.dtw\_analysis)@\spxentry{dtw\_clustering}\spxextra{class in dtwhaclustering.dtw\_analysis}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules/dtw_analysis:dtwhaclustering.dtw_analysis.dtw_clustering}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{class }}\sphinxcode{\sphinxupquote{dtwhaclustering.dtw\_analysis.}}\sphinxbfcode{\sphinxupquote{dtw\_clustering}}}{\emph{\DUrole{n}{matrix}}, \emph{\DUrole{n}{labels}\DUrole{o}{=}\DUrole{default_value}{{[}{]}}}, \emph{\DUrole{n}{longitudes}\DUrole{o}{=}\DUrole{default_value}{{[}{]}}}, \emph{\DUrole{n}{latitudes}\DUrole{o}{=}\DUrole{default_value}{{[}{]}}}}{}
\sphinxAtStartPar
Bases: \sphinxcode{\sphinxupquote{object}}
\index{compute\_cluster() (dtwhaclustering.dtw\_analysis.dtw\_clustering method)@\spxentry{compute\_cluster()}\spxextra{dtwhaclustering.dtw\_analysis.dtw\_clustering method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules/dtw_analysis:dtwhaclustering.dtw_analysis.dtw_clustering.compute_cluster}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{compute\_cluster}}}{\emph{\DUrole{n}{clusterMatrix}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{n}{window}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}constrained\textquotesingle{}}}, \emph{\DUrole{n}{windowfrac}\DUrole{o}{=}\DUrole{default_value}{0.25}}}{}~\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{compute\_cluster}} \textendash{} data matrix to cluster

\item[{Returns}] \leavevmode
\sphinxAtStartPar
model, cluster\_idx

\end{description}\end{quote}

\end{fulllineitems}

\index{compute\_cut\_off\_inconsistency() (dtwhaclustering.dtw\_analysis.dtw\_clustering method)@\spxentry{compute\_cut\_off\_inconsistency()}\spxextra{dtwhaclustering.dtw\_analysis.dtw\_clustering method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules/dtw_analysis:dtwhaclustering.dtw_analysis.dtw_clustering.compute_cut_off_inconsistency}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{compute\_cut\_off\_inconsistency}}}{\emph{\DUrole{n}{t}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{n}{depth}\DUrole{o}{=}\DUrole{default_value}{2}}, \emph{\DUrole{n}{criterion}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}inconsistent\textquotesingle{}}}, \emph{\DUrole{n}{return\_cluster}\DUrole{o}{=}\DUrole{default_value}{False}}}{}
\sphinxAtStartPar
Calculate inconsistency statistics on a linkage matrix following \sphinxtitleref{scipy.cluster.hierarchy.inconsistent}. It compares each cluster merge’s height \sphinxtitleref{h} to the average \sphinxtitleref{avg} and normalize it by the standard deviation \sphinxtitleref{std} formed over the depth previous levels
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{t}} (\sphinxstyleliteralemphasis{\sphinxupquote{scalar}}) \textendash{} threshold to apply when forming flat clusters. See scipy.cluster.hierarchy.fcluster for details

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{depth}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} The maximum depth to perform the inconsistency calculation

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxAtStartPar
maximum inconsistency coefficient for each non\sphinxhyphen{}singleton cluster and its children; the inconsistency matrix (matrix with rows of avg, std, count, inconsistency); cluster

\end{description}\end{quote}

\end{fulllineitems}

\index{compute\_dendrogram() (dtwhaclustering.dtw\_analysis.dtw\_clustering method)@\spxentry{compute\_dendrogram()}\spxextra{dtwhaclustering.dtw\_analysis.dtw\_clustering method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules/dtw_analysis:dtwhaclustering.dtw_analysis.dtw_clustering.compute_dendrogram}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{compute\_dendrogram}}}{\emph{\DUrole{n}{color\_thresh}\DUrole{o}{=}\DUrole{default_value}{None}}}{}
\end{fulllineitems}

\index{compute\_distance\_accl() (dtwhaclustering.dtw\_analysis.dtw\_clustering method)@\spxentry{compute\_distance\_accl()}\spxextra{dtwhaclustering.dtw\_analysis.dtw\_clustering method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules/dtw_analysis:dtwhaclustering.dtw_analysis.dtw_clustering.compute_distance_accl}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{compute\_distance\_accl}}}{\emph{\DUrole{n}{clusterMatrix}\DUrole{o}{=}\DUrole{default_value}{None}}}{}
\end{fulllineitems}

\index{compute\_distance\_matrix() (dtwhaclustering.dtw\_analysis.dtw\_clustering method)@\spxentry{compute\_distance\_matrix()}\spxextra{dtwhaclustering.dtw\_analysis.dtw\_clustering method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules/dtw_analysis:dtwhaclustering.dtw_analysis.dtw_clustering.compute_distance_matrix}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{compute\_distance\_matrix}}}{\emph{\DUrole{n}{compact}\DUrole{o}{=}\DUrole{default_value}{True}}, \emph{\DUrole{n}{block}\DUrole{o}{=}\DUrole{default_value}{None}}}{}
\end{fulllineitems}

\index{get\_linkage() (dtwhaclustering.dtw\_analysis.dtw\_clustering method)@\spxentry{get\_linkage()}\spxextra{dtwhaclustering.dtw\_analysis.dtw\_clustering method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules/dtw_analysis:dtwhaclustering.dtw_analysis.dtw_clustering.get_linkage}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{get\_linkage}}}{\emph{\DUrole{n}{clusterMatrix}\DUrole{o}{=}\DUrole{default_value}{None}}}{}
\end{fulllineitems}

\index{optimum\_cluster\_elbow() (dtwhaclustering.dtw\_analysis.dtw\_clustering method)@\spxentry{optimum\_cluster\_elbow()}\spxextra{dtwhaclustering.dtw\_analysis.dtw\_clustering method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules/dtw_analysis:dtwhaclustering.dtw_analysis.dtw_clustering.optimum_cluster_elbow}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{optimum\_cluster\_elbow}}}{\emph{\DUrole{n}{minmax}\DUrole{o}{=}\DUrole{default_value}{False}}, \emph{\DUrole{n}{plotloc}\DUrole{o}{=}\DUrole{default_value}{False}}}{}
\sphinxAtStartPar
Gives the optimum number of clusters required to express the maximum difference in the similarity using the elbow method

\end{fulllineitems}

\index{plot\_cluster\_geomap() (dtwhaclustering.dtw\_analysis.dtw\_clustering method)@\spxentry{plot\_cluster\_geomap()}\spxextra{dtwhaclustering.dtw\_analysis.dtw\_clustering method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules/dtw_analysis:dtwhaclustering.dtw_analysis.dtw_clustering.plot_cluster_geomap}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{plot\_cluster\_geomap}}}{\emph{\DUrole{n}{dtw\_distance}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}optimal\textquotesingle{}}}, \emph{\DUrole{n}{minlon}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{n}{maxlon}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{n}{minlat}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{n}{maxlat}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{n}{figname}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}dtw\_cluster.pdf\textquotesingle{}}}, \emph{\DUrole{n}{colorbar}\DUrole{o}{=}\DUrole{default_value}{True}}, \emph{\DUrole{n}{colorbarstep}\DUrole{o}{=}\DUrole{default_value}{1}}, \emph{\DUrole{n}{doffset}\DUrole{o}{=}\DUrole{default_value}{1}}, \emph{\DUrole{n}{dpi}\DUrole{o}{=}\DUrole{default_value}{720}}, \emph{\DUrole{n}{topo\_data}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}@earth\_relief\_15s\textquotesingle{}}}, \emph{\DUrole{n}{plot\_topo}\DUrole{o}{=}\DUrole{default_value}{False}}, \emph{\DUrole{n}{markerstyle}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}c0.3c\textquotesingle{}}}, \emph{\DUrole{n}{cmap\_topo}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}topo\textquotesingle{}}}, \emph{\DUrole{n}{cmap\_data}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}jet\textquotesingle{}}}, \emph{\DUrole{n}{projection}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}M4i\textquotesingle{}}}, \emph{\DUrole{n}{topo\_cpt\_range}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}\sphinxhyphen{}8000/8000/1000\textquotesingle{}}}, \emph{\DUrole{n}{landcolor}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}\#666666\textquotesingle{}}}}{}
\sphinxAtStartPar
Plot the cluster points on a geographical map
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{figname}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} output figure name

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{colorbar}} (\sphinxstyleliteralemphasis{\sphinxupquote{bool}}) \textendash{} plot colorbar

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{colorbarstep}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} step for the colorbar

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{cmap}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} colormap for the cluster points

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{projection}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} map projection

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{topo\_data}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} topographic data resolution, see \sphinxhref{https://docs.generic-mapping-tools.org/latest/datasets/remote-data.html\#global-earth-relief-grids}{pygmt docs} for details

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{topo\_cpt\_range}} \textendash{} min/max/step for topographic color

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{landcolor}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} color for land region

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{dpi}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} output figure resolution

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{plot\_cluster\_geomap\_interpolated() (dtwhaclustering.dtw\_analysis.dtw\_clustering method)@\spxentry{plot\_cluster\_geomap\_interpolated()}\spxextra{dtwhaclustering.dtw\_analysis.dtw\_clustering method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules/dtw_analysis:dtwhaclustering.dtw_analysis.dtw_clustering.plot_cluster_geomap_interpolated}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{plot\_cluster\_geomap\_interpolated}}}{\emph{\DUrole{n}{dtw\_distance}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}optimal\textquotesingle{}}}, \emph{\DUrole{n}{lonrange}\DUrole{o}{=}\DUrole{default_value}{(120.0, 122.0)}}, \emph{\DUrole{n}{latrange}\DUrole{o}{=}\DUrole{default_value}{(21.8, 25.6)}}, \emph{\DUrole{n}{gridstep}\DUrole{o}{=}\DUrole{default_value}{0.01}}, \emph{\DUrole{n}{figname}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}dtw\_cluster\_interp.pdf\textquotesingle{}}}, \emph{\DUrole{n}{minlon}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{n}{maxlon}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{n}{minlat}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{n}{maxlat}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{n}{markerstyle}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}c0.3c\textquotesingle{}}}, \emph{\DUrole{n}{dpi}\DUrole{o}{=}\DUrole{default_value}{720}}, \emph{\DUrole{n}{doffset}\DUrole{o}{=}\DUrole{default_value}{1}}, \emph{\DUrole{n}{plot\_data}\DUrole{o}{=}\DUrole{default_value}{True}}, \emph{\DUrole{n}{plot\_intrp}\DUrole{o}{=}\DUrole{default_value}{True}}}{}~\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{dtw\_distance}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{float}}) \textendash{} use \sphinxtitleref{dtw\_distance} value to obtain the cluster division. If \sphinxtitleref{optimal} then the optimal \sphinxtitleref{dtw\_distance} will be calculated

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{lonrange}} (\sphinxstyleliteralemphasis{\sphinxupquote{tuple}}) \textendash{} minimum and maximum of longitude values for interpolation

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{latrange}} (\sphinxstyleliteralemphasis{\sphinxupquote{tuple}}) \textendash{} minimum and maximum of latitude values for interpolation

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{gridstep}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}) \textendash{} step size for interpolation

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{plot\_cluster\_xymap() (dtwhaclustering.dtw\_analysis.dtw\_clustering method)@\spxentry{plot\_cluster\_xymap()}\spxextra{dtwhaclustering.dtw\_analysis.dtw\_clustering method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules/dtw_analysis:dtwhaclustering.dtw_analysis.dtw_clustering.plot_cluster_xymap}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{plot\_cluster\_xymap}}}{\emph{\DUrole{n}{dtw\_distance}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}optimal\textquotesingle{}}}, \emph{\DUrole{n}{figname}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{n}{xlabel}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}x\textquotesingle{}}}, \emph{\DUrole{n}{ylabel}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}y\textquotesingle{}}}, \emph{\DUrole{n}{colorbar}\DUrole{o}{=}\DUrole{default_value}{True}}, \emph{\DUrole{n}{colorbarstep}\DUrole{o}{=}\DUrole{default_value}{1}}, \emph{\DUrole{n}{scale}\DUrole{o}{=}\DUrole{default_value}{2}}, \emph{\DUrole{n}{fontsize}\DUrole{o}{=}\DUrole{default_value}{26}}, \emph{\DUrole{n}{markersize}\DUrole{o}{=}\DUrole{default_value}{12}}, \emph{\DUrole{n}{axesfontsize}\DUrole{o}{=}\DUrole{default_value}{20}}, \emph{\DUrole{n}{xtickstep}\DUrole{o}{=}\DUrole{default_value}{1}}, \emph{\DUrole{n}{tickfontsize}\DUrole{o}{=}\DUrole{default_value}{20}}, \emph{\DUrole{n}{edgecolors}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}k\textquotesingle{}}}, \emph{\DUrole{n}{cmap}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}jet\textquotesingle{}}}, \emph{\DUrole{n}{linewidths}\DUrole{o}{=}\DUrole{default_value}{2}}, \emph{\DUrole{n}{cbarsize}\DUrole{o}{=}\DUrole{default_value}{18}}}{}
\sphinxAtStartPar
Plot the cluster points in a rectangular coordinate system
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{dtw\_distance}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{float}}) \textendash{} use \sphinxtitleref{dtw\_distance} value to obtain the cluster division. If \sphinxtitleref{optimal} then the optimal \sphinxtitleref{dtw\_distance} will be calculated

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{figname}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} output figure name

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{colorbar}} (\sphinxstyleliteralemphasis{\sphinxupquote{bool}}) \textendash{} plot colorbar

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{colorbarstep}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} step for the colorbar

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{scale}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} figure scale

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{markersize}} \textendash{} cluster points size

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{edgecolors}} \textendash{} marker edge color

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{cmap}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} colormap for the cluster points

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxAtStartPar
figure, axes

\end{description}\end{quote}

\end{fulllineitems}

\index{plot\_dendrogram() (dtwhaclustering.dtw\_analysis.dtw\_clustering method)@\spxentry{plot\_dendrogram()}\spxextra{dtwhaclustering.dtw\_analysis.dtw\_clustering method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules/dtw_analysis:dtwhaclustering.dtw_analysis.dtw_clustering.plot_dendrogram}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{plot\_dendrogram}}}{\emph{\DUrole{n}{figname}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{n}{figsize}\DUrole{o}{=}\DUrole{default_value}{(20, 8)}}, \emph{\DUrole{n}{xtickfontsize}\DUrole{o}{=}\DUrole{default_value}{26}}, \emph{\DUrole{n}{labelfontsize}\DUrole{o}{=}\DUrole{default_value}{26}}, \emph{\DUrole{n}{xlabel}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}3\sphinxhyphen{}D Stations\textquotesingle{}}}, \emph{\DUrole{n}{ylabel}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}DTW Distance\textquotesingle{}}}, \emph{\DUrole{n}{truncate\_p}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{n}{distance\_threshold}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{n}{annotate\_above}\DUrole{o}{=}\DUrole{default_value}{0}}, \emph{\DUrole{n}{plotpdf}\DUrole{o}{=}\DUrole{default_value}{True}}, \emph{\DUrole{n}{leaf\_rotation}\DUrole{o}{=}\DUrole{default_value}{0}}}{}~\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{truncate\_p}} \textendash{} show only last truncate\_p out of all merged branches

\end{description}\end{quote}

\end{fulllineitems}

\index{plot\_hac\_iteration() (dtwhaclustering.dtw\_analysis.dtw\_clustering method)@\spxentry{plot\_hac\_iteration()}\spxextra{dtwhaclustering.dtw\_analysis.dtw\_clustering method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules/dtw_analysis:dtwhaclustering.dtw_analysis.dtw_clustering.plot_hac_iteration}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{plot\_hac\_iteration}}}{\emph{\DUrole{n}{figname}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{n}{figsize}\DUrole{o}{=}\DUrole{default_value}{(10, 8)}}, \emph{\DUrole{n}{xtickfontsize}\DUrole{o}{=}\DUrole{default_value}{26}}, \emph{\DUrole{n}{labelfontsize}\DUrole{o}{=}\DUrole{default_value}{26}}, \emph{\DUrole{n}{xlabel}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}Iteration \#\textquotesingle{}}}, \emph{\DUrole{n}{ylabel}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}DTW Distance\textquotesingle{}}}, \emph{\DUrole{n}{plot\_color}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}C0\textquotesingle{}}}, \emph{\DUrole{n}{plotpdf}\DUrole{o}{=}\DUrole{default_value}{True}}}{}
\end{fulllineitems}

\index{plot\_optimum\_cluster() (dtwhaclustering.dtw\_analysis.dtw\_clustering method)@\spxentry{plot\_optimum\_cluster()}\spxextra{dtwhaclustering.dtw\_analysis.dtw\_clustering method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules/dtw_analysis:dtwhaclustering.dtw_analysis.dtw_clustering.plot_optimum_cluster}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{plot\_optimum\_cluster}}}{\emph{\DUrole{n}{max\_d}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{n}{figname}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{n}{figsize}\DUrole{o}{=}\DUrole{default_value}{(10, 6)}}, \emph{\DUrole{n}{plotpdf}\DUrole{o}{=}\DUrole{default_value}{True}}, \emph{\DUrole{n}{xlabel}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}Number of Clusters\textquotesingle{}}}, \emph{\DUrole{n}{ylabel}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}Distance\textquotesingle{}}}, \emph{\DUrole{n}{accl\_label}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}Curvature\textquotesingle{}}}, \emph{\DUrole{n}{accl\_color}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}C10\textquotesingle{}}}, \emph{\DUrole{n}{dist\_label}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}DTW Distance\textquotesingle{}}}, \emph{\DUrole{n}{dist\_color}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}k\textquotesingle{}}}, \emph{\DUrole{n}{xlim}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{n}{legend\_outside}\DUrole{o}{=}\DUrole{default_value}{True}}, \emph{\DUrole{n}{fontsize}\DUrole{o}{=}\DUrole{default_value}{26}}, \emph{\DUrole{n}{xlabelfont}\DUrole{o}{=}\DUrole{default_value}{26}}, \emph{\DUrole{n}{ylabelfont}\DUrole{o}{=}\DUrole{default_value}{26}}}{}~\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{xlim}} (\sphinxstyleliteralemphasis{\sphinxupquote{list}}) \textendash{} x limits of the plot e.g., {[}1,2{]}

\end{description}\end{quote}

\end{fulllineitems}

\index{plot\_polar\_dendrogram() (dtwhaclustering.dtw\_analysis.dtw\_clustering method)@\spxentry{plot\_polar\_dendrogram()}\spxextra{dtwhaclustering.dtw\_analysis.dtw\_clustering method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules/dtw_analysis:dtwhaclustering.dtw_analysis.dtw_clustering.plot_polar_dendrogram}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{plot\_polar\_dendrogram}}}{\emph{\DUrole{n}{figsize}\DUrole{o}{=}\DUrole{default_value}{(20, 20)}}, \emph{\DUrole{n}{normfactor}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{n}{Nyticks}\DUrole{o}{=}\DUrole{default_value}{7}}, \emph{\DUrole{n}{gap}\DUrole{o}{=}\DUrole{default_value}{0.05}}, \emph{\DUrole{n}{Nsmooth}\DUrole{o}{=}\DUrole{default_value}{100}}, \emph{\DUrole{n}{linewidth}\DUrole{o}{=}\DUrole{default_value}{1}}, \emph{\DUrole{n}{xtickfontsize}\DUrole{o}{=}\DUrole{default_value}{20}}, \emph{\DUrole{n}{ytickfontsize}\DUrole{o}{=}\DUrole{default_value}{20}}, \emph{\DUrole{n}{plotstyle}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}seaborn\textquotesingle{}}}, \emph{\DUrole{n}{figname}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{n}{plotpdf}\DUrole{o}{=}\DUrole{default_value}{True}}, \emph{\DUrole{n}{gridcolor}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{n}{gridstyle}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}\sphinxhyphen{}\sphinxhyphen{}\textquotesingle{}}}, \emph{\DUrole{n}{gridwidth}\DUrole{o}{=}\DUrole{default_value}{1}}, \emph{\DUrole{n}{tickfontweight}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}bold\textquotesingle{}}}, \emph{\DUrole{n}{distance\_threshold}\DUrole{o}{=}\DUrole{default_value}{None}}}{}
\sphinxAtStartPar
Plot polar dendrogram of the clustering result
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{figsize}} \textendash{} figure size

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{normfactor}} \textendash{} (optional) normalization factor for the log spacing between the yticks, \sphinxhyphen{}np.log(dcoord+normfactor)

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Nyticks}} \textendash{} number of y ticks

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{gap}} \textendash{} gap for the yticks

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{plotstyle}} \textendash{} matplotlib plot style, \sphinxtitleref{plotstyle} by default

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{distance\_threshold}} \textendash{} str, float. threshold for the coloring of branches. If str=”optimal”, then the optimal number of clusters based on elbow method will be used

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{plot\_signals() (dtwhaclustering.dtw\_analysis.dtw\_clustering method)@\spxentry{plot\_signals()}\spxextra{dtwhaclustering.dtw\_analysis.dtw\_clustering method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules/dtw_analysis:dtwhaclustering.dtw_analysis.dtw_clustering.plot_signals}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{plot\_signals}}}{\emph{\DUrole{n}{figname}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{n}{figsize}\DUrole{o}{=}\DUrole{default_value}{(10, 6)}}, \emph{\DUrole{n}{fontsize}\DUrole{o}{=}\DUrole{default_value}{26}}}{}~\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{figname}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} output figure name

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{figsize}} (\sphinxstyleliteralemphasis{\sphinxupquote{tuple}}) \textendash{} output figure size

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{significance\_test() (dtwhaclustering.dtw\_analysis.dtw\_clustering method)@\spxentry{significance\_test()}\spxextra{dtwhaclustering.dtw\_analysis.dtw\_clustering method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules/dtw_analysis:dtwhaclustering.dtw_analysis.dtw_clustering.significance_test}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{significance\_test}}}{\emph{\DUrole{n}{numsimulations}\DUrole{o}{=}\DUrole{default_value}{10}}, \emph{\DUrole{n}{outfile}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}pickleFiles/dU\_accl\_sim\_results.pickle\textquotesingle{}}}, \emph{\DUrole{n}{fresh\_start}\DUrole{o}{=}\DUrole{default_value}{False}}}{}
\end{fulllineitems}


\end{fulllineitems}

\index{dtw\_signal\_pairs (class in dtwhaclustering.dtw\_analysis)@\spxentry{dtw\_signal\_pairs}\spxextra{class in dtwhaclustering.dtw\_analysis}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules/dtw_analysis:dtwhaclustering.dtw_analysis.dtw_signal_pairs}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{class }}\sphinxcode{\sphinxupquote{dtwhaclustering.dtw\_analysis.}}\sphinxbfcode{\sphinxupquote{dtw\_signal\_pairs}}}{\emph{\DUrole{n}{s1}}, \emph{\DUrole{n}{s2}}, \emph{\DUrole{n}{labels}\DUrole{o}{=}\DUrole{default_value}{{[}\textquotesingle{}s1\textquotesingle{}, \textquotesingle{}s2\textquotesingle{}{]}}}}{}
\sphinxAtStartPar
Bases: \sphinxcode{\sphinxupquote{object}}
\index{compute\_distance() (dtwhaclustering.dtw\_analysis.dtw\_signal\_pairs method)@\spxentry{compute\_distance()}\spxextra{dtwhaclustering.dtw\_analysis.dtw\_signal\_pairs method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules/dtw_analysis:dtwhaclustering.dtw_analysis.dtw_signal_pairs.compute_distance}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{compute\_distance}}}{\emph{\DUrole{n}{pruning}\DUrole{o}{=}\DUrole{default_value}{True}}, \emph{\DUrole{n}{best\_path}\DUrole{o}{=}\DUrole{default_value}{False}}}{}
\sphinxAtStartPar
Returns the DTW distance
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{pruning}} (\sphinxstyleliteralemphasis{\sphinxupquote{boolean}}) \textendash{} prunes computations by setting max\_dist to the Euclidean upper bound

\end{description}\end{quote}

\end{fulllineitems}

\index{compute\_warping\_path() (dtwhaclustering.dtw\_analysis.dtw\_signal\_pairs method)@\spxentry{compute\_warping\_path()}\spxextra{dtwhaclustering.dtw\_analysis.dtw\_signal\_pairs method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules/dtw_analysis:dtwhaclustering.dtw_analysis.dtw_signal_pairs.compute_warping_path}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{compute\_warping\_path}}}{\emph{\DUrole{n}{windowfrac}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{n}{psi}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{n}{fullmatrix}\DUrole{o}{=}\DUrole{default_value}{False}}}{}
\sphinxAtStartPar
Returns the DTW path
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{windowfrac}} \textendash{} Fraction of the signal length. Only allow for shifts up to this amount away from the two diagonals.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{psi}} \textendash{} Up to psi number of start and end points of a sequence can be ignored if this would lead to a lower distance

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{full\_matrix}} \textendash{} The full matrix of all warping paths (or accumulated cost matrix) is built

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{plot\_matrix() (dtwhaclustering.dtw\_analysis.dtw\_signal\_pairs method)@\spxentry{plot\_matrix()}\spxextra{dtwhaclustering.dtw\_analysis.dtw\_signal\_pairs method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules/dtw_analysis:dtwhaclustering.dtw_analysis.dtw_signal_pairs.plot_matrix}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{plot\_matrix}}}{\emph{\DUrole{n}{windowfrac}\DUrole{o}{=}\DUrole{default_value}{0.2}}, \emph{\DUrole{n}{psi}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{n}{figname}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{n}{shownumbers}\DUrole{o}{=}\DUrole{default_value}{False}}, \emph{\DUrole{n}{showlegend}\DUrole{o}{=}\DUrole{default_value}{True}}}{}
\sphinxAtStartPar
Plot the signals with the DTW matrix
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{figname}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} output figure name

\end{description}\end{quote}

\end{fulllineitems}

\index{plot\_signals() (dtwhaclustering.dtw\_analysis.dtw\_signal\_pairs method)@\spxentry{plot\_signals()}\spxextra{dtwhaclustering.dtw\_analysis.dtw\_signal\_pairs method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules/dtw_analysis:dtwhaclustering.dtw_analysis.dtw_signal_pairs.plot_signals}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{plot\_signals}}}{\emph{\DUrole{n}{figname}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{n}{figsize}\DUrole{o}{=}\DUrole{default_value}{(12, 6)}}}{}
\sphinxAtStartPar
Plot the signals
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{figname}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} output figure name

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{figsize}} (\sphinxstyleliteralemphasis{\sphinxupquote{tuple}}) \textendash{} output figure size

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxAtStartPar
figure and axes object

\end{description}\end{quote}

\end{fulllineitems}

\index{plot\_warping\_path() (dtwhaclustering.dtw\_analysis.dtw\_signal\_pairs method)@\spxentry{plot\_warping\_path()}\spxextra{dtwhaclustering.dtw\_analysis.dtw\_signal\_pairs method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules/dtw_analysis:dtwhaclustering.dtw_analysis.dtw_signal_pairs.plot_warping_path}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{plot\_warping\_path}}}{\emph{\DUrole{n}{figname}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{n}{figsize}\DUrole{o}{=}\DUrole{default_value}{(12, 6)}}}{}
\sphinxAtStartPar
Plot the signals with the warping paths
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{figname}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} output figure name

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{figsize}} (\sphinxstyleliteralemphasis{\sphinxupquote{tuple}}) \textendash{} output figure size

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{noise\_robustness\_test() (in module dtwhaclustering.dtw\_analysis)@\spxentry{noise\_robustness\_test()}\spxextra{in module dtwhaclustering.dtw\_analysis}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules/dtw_analysis:dtwhaclustering.dtw_analysis.noise_robustness_test}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{dtwhaclustering.dtw\_analysis.}}\sphinxbfcode{\sphinxupquote{noise\_robustness\_test}}}{\emph{\DUrole{n}{clean\_df}}, \emph{\DUrole{n}{scale}\DUrole{o}{=}\DUrole{default_value}{0.1}}}{}
\end{fulllineitems}

\index{plot\_cluster() (in module dtwhaclustering.dtw\_analysis)@\spxentry{plot\_cluster()}\spxextra{in module dtwhaclustering.dtw\_analysis}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules/dtw_analysis:dtwhaclustering.dtw_analysis.plot_cluster}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{dtwhaclustering.dtw\_analysis.}}\sphinxbfcode{\sphinxupquote{plot\_cluster}}}{\emph{\DUrole{n}{lons}}, \emph{\DUrole{n}{lats}}, \emph{\DUrole{n}{figname}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{n}{figsize}\DUrole{o}{=}\DUrole{default_value}{(10, 10)}}, \emph{\DUrole{n}{plotpdf}\DUrole{o}{=}\DUrole{default_value}{True}}, \emph{\DUrole{n}{labels}\DUrole{o}{=}\DUrole{default_value}{{[}{]}}}, \emph{\DUrole{n}{markersize}\DUrole{o}{=}\DUrole{default_value}{20}}}{}~\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{figname}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} output figure name

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{figsize}} (\sphinxstyleliteralemphasis{\sphinxupquote{tuple}}) \textendash{} output figure size

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{plot\_signals() (in module dtwhaclustering.dtw\_analysis)@\spxentry{plot\_signals()}\spxextra{in module dtwhaclustering.dtw\_analysis}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules/dtw_analysis:dtwhaclustering.dtw_analysis.plot_signals}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{dtwhaclustering.dtw\_analysis.}}\sphinxbfcode{\sphinxupquote{plot\_signals}}}{\emph{\DUrole{n}{matrix}}, \emph{\DUrole{n}{labels}\DUrole{o}{=}\DUrole{default_value}{{[}{]}}}, \emph{\DUrole{n}{figname}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{n}{plotpdf}\DUrole{o}{=}\DUrole{default_value}{True}}, \emph{\DUrole{n}{figsize}\DUrole{o}{=}\DUrole{default_value}{(10, 8)}}, \emph{\DUrole{n}{ylabelsize}\DUrole{o}{=}\DUrole{default_value}{26}}, \emph{\DUrole{n}{color}\DUrole{o}{=}\DUrole{default_value}{None}}}{}
\sphinxAtStartPar
Plot signals
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{color}} \textendash{} list of colors. If None then matplotlib defaults color sequence will be used

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{figname}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} output figure name

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{figsize}} (\sphinxstyleliteralemphasis{\sphinxupquote{tuple}}) \textendash{} output figure size

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{shuffle\_signals() (in module dtwhaclustering.dtw\_analysis)@\spxentry{shuffle\_signals()}\spxextra{in module dtwhaclustering.dtw\_analysis}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules/dtw_analysis:dtwhaclustering.dtw_analysis.shuffle_signals}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{dtwhaclustering.dtw\_analysis.}}\sphinxbfcode{\sphinxupquote{shuffle\_signals}}}{\emph{\DUrole{n}{matrix}}, \emph{\DUrole{n}{labels}\DUrole{o}{=}\DUrole{default_value}{{[}{]}}}, \emph{\DUrole{n}{plot\_signals}\DUrole{o}{=}\DUrole{default_value}{False}}, \emph{\DUrole{n}{figsize}\DUrole{o}{=}\DUrole{default_value}{(10, 12)}}, \emph{\DUrole{n}{figname}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{n}{plotpdf}\DUrole{o}{=}\DUrole{default_value}{True}}}{}~\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{figname}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} output figure name

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{figsize}} (\sphinxstyleliteralemphasis{\sphinxupquote{tuple}}) \textendash{} output figure size

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}



\chapter{dtwhaclustering.plot\_stations}
\label{\detokenize{modules/plot_stations:module-dtwhaclustering.plot_stations}}\label{\detokenize{modules/plot_stations:dtwhaclustering-plot-stations}}\label{\detokenize{modules/plot_stations::doc}}\index{module@\spxentry{module}!dtwhaclustering.plot\_stations@\spxentry{dtwhaclustering.plot\_stations}}\index{dtwhaclustering.plot\_stations@\spxentry{dtwhaclustering.plot\_stations}!module@\spxentry{module}}
\sphinxAtStartPar
Plot topographic station map
\begin{quote}\begin{description}
\item[{author}] \leavevmode
\sphinxAtStartPar
Utpal Kumar, Institute of Earth Sciences, Academia Sinica

\end{description}\end{quote}
\index{plot\_station\_map() (in module dtwhaclustering.plot\_stations)@\spxentry{plot\_station\_map()}\spxextra{in module dtwhaclustering.plot\_stations}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules/plot_stations:dtwhaclustering.plot_stations.plot_station_map}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{dtwhaclustering.plot\_stations.}}\sphinxbfcode{\sphinxupquote{plot\_station\_map}}}{\emph{\DUrole{n}{station\_data}}, \emph{\DUrole{n}{minlon}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{n}{maxlon}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{n}{minlat}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{n}{maxlat}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{n}{outfig}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}station\_map.png\textquotesingle{}}}, \emph{\DUrole{n}{datacolor}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}blue\textquotesingle{}}}, \emph{\DUrole{n}{topo\_data}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}@earth\_relief\_15s\textquotesingle{}}}, \emph{\DUrole{n}{cmap}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}etopo1\textquotesingle{}}}, \emph{\DUrole{n}{projection}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}M4i\textquotesingle{}}}, \emph{\DUrole{n}{datalabel}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}Stations\textquotesingle{}}}, \emph{\DUrole{n}{markerstyle}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}i10p\textquotesingle{}}}, \emph{\DUrole{n}{random\_station\_label}\DUrole{o}{=}\DUrole{default_value}{False}}, \emph{\DUrole{n}{stn\_labels}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{n}{justify}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}left\textquotesingle{}}}, \emph{\DUrole{n}{labelfont}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}6p,Helvetica\sphinxhyphen{}Bold,black\textquotesingle{}}}, \emph{\DUrole{n}{offset}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}5p/\sphinxhyphen{}5p\textquotesingle{}}}, \emph{\DUrole{n}{stn\_labels\_color}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}red\textquotesingle{}}}, \emph{\DUrole{n}{rand\_justify}\DUrole{o}{=}\DUrole{default_value}{False}}}{}
\sphinxAtStartPar
Plot topographic station map using PyGMT
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{station\_data}} \textendash{} Pandas dataframe containing columns \sphinxtitleref{lon}, \sphinxtitleref{lat}

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{minlon}} \textendash{} Minimum longitude of the map (optional)

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{maxlon}} \textendash{} Maximum longitude of the map (optional)

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{minlat}} \textendash{} Minimum latitude of the map (optional)

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{maxlat}} \textendash{} Maximum latitude of the map (optional)

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{datacolor}} \textendash{} color of the data point to plot

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{topo\_data}} \textendash{} etopo data file

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{cmap}} \textendash{} colormap for the output topography

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{projection}} \textendash{} projection of the map. Mercator of width 4 inch by default

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{datalabel}} \textendash{} Label for the data

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{markerstyle}} \textendash{} Style of the marker. Inverted triangle of size 10p by default.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{outfig}} \textendash{} Output figure path

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{random\_station\_label}} \textendash{} int. label randomly selected \sphinxtitleref{random\_station\_label} of stations

\end{itemize}

\end{description}\end{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{from} \PYG{n+nn}{dtwhaclustering} \PYG{k+kn}{import} \PYG{n}{plot\PYGZus{}stations}

\PYG{n}{outloc}\PYG{o}{=}\PYG{n}{os}\PYG{o}{.}\PYG{n}{path}\PYG{o}{.}\PYG{n}{join}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Figures}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Maps}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{figname} \PYG{o}{=} \PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{outloc}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s1}{/station\PYGZus{}map.pdf}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{kwargs}\PYG{o}{=}\PYG{p}{\PYGZob{}}
    \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{labelfont}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{10p,Helvetica\PYGZhy{}Bold,black}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
    \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{outfig}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:}\PYG{n}{figname}\PYG{p}{,}
    \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{stn\PYGZus{}labels}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PKGM}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{YMSM}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{VR02}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{HUWE}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{LNCH}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{CHEN}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{TUNH}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{ERPN}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{FALI}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{WANS}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,}
    \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{justify}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{right}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
    \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{offset}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZhy{}10p/\PYGZhy{}1p}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{markerstyle}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{i12p}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{stn\PYGZus{}labels\PYGZus{}color}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{red}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{rand\PYGZus{}justify}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{k+kc}{True}
\PYG{p}{\PYGZcb{}}
\PYG{n}{plot\PYGZus{}stations}\PYG{o}{.}\PYG{n}{plot\PYGZus{}station\PYGZus{}map}\PYG{p}{(}\PYG{n}{station\PYGZus{}data} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{helper\PYGZus{}files/selected\PYGZus{}stations\PYGZus{}info.txt}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{o}{*}\PYG{o}{*}\PYG{n}{kwargs}\PYG{p}{)}
\end{sphinxVerbatim}

\end{fulllineitems}



\chapter{Indices and tables}
\label{\detokenize{index:indices-and-tables}}\begin{itemize}
\item {} 
\sphinxAtStartPar
\DUrole{xref,std,std-ref}{genindex}

\item {} 
\sphinxAtStartPar
\DUrole{xref,std,std-ref}{modindex}

\item {} 
\sphinxAtStartPar
\DUrole{xref,std,std-ref}{search}

\end{itemize}


\renewcommand{\indexname}{Python Module Index}
\begin{sphinxtheindex}
\let\bigletter\sphinxstyleindexlettergroup
\bigletter{d}
\item\relax\sphinxstyleindexentry{dtwhaclustering}\sphinxstyleindexpageref{usage/module_contents:\detokenize{module-dtwhaclustering}}
\item\relax\sphinxstyleindexentry{dtwhaclustering.analysis\_support}\sphinxstyleindexpageref{modules/analysis_support:\detokenize{module-dtwhaclustering.analysis_support}}
\item\relax\sphinxstyleindexentry{dtwhaclustering.dtw\_analysis}\sphinxstyleindexpageref{modules/dtw_analysis:\detokenize{module-dtwhaclustering.dtw_analysis}}
\item\relax\sphinxstyleindexentry{dtwhaclustering.leastSquareModeling}\sphinxstyleindexpageref{modules/leastSquareModeling:\detokenize{module-dtwhaclustering.leastSquareModeling}}
\item\relax\sphinxstyleindexentry{dtwhaclustering.plot\_linear\_trend}\sphinxstyleindexpageref{modules/plot_linear_trend:\detokenize{module-dtwhaclustering.plot_linear_trend}}
\item\relax\sphinxstyleindexentry{dtwhaclustering.plot\_stations}\sphinxstyleindexpageref{modules/plot_stations:\detokenize{module-dtwhaclustering.plot_stations}}
\end{sphinxtheindex}

\renewcommand{\indexname}{Index}
\printindex
\end{document}